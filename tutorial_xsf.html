<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Using academicons -->
  <!-- <link rel="stylesheet" href="assets/academicons-1.9/css/academicons.min.css"/> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <!-- Using fontawesome -->
  <script src="https://kit.fontawesome.com/f5e5434f52.js" crossorigin="anonymous"></script>


  <!-- <link rel="apple-touch-icon" href="./favicon.ico" /> -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>XSF Tutorial</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
  <!-- <meta content="" name="description"> -->
  <!-- <meta content="" name="keywords"> -->
  <meta property="og:title" content="XSF Tutorial" />
  <meta property="og:locale" content="en_UK" />
  <meta name="description" content="XSF Tutorial" />
  <meta property="og:description" content="XSF Tutorial" />
  <link rel="canonical" href="https://peterboorman.com/" />
  <meta property="og:url" content="https://peterboorman.com/" />
  <meta property="og:site_name" content="XSF Tutorial" />
  <script type="application/ld+json">
  {"@type":"WebSite","headline":"XSF Tutorial","url":"https://peterboorman.com/tutorial_bxa.html","description":"XSF Tutorial","name":"XSF Tutorial","@context":"https://schema.org"}</script>

  <!-- Favicons -->
  <!-- <link href="assets/img/favicon.png" rel="icon"> -->
  <link href="favicon.ico" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: iPortfolio - v1.4.1
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">
      <div class="profile">
        <a href="http://johannesbuchner.github.io/BXA/xspec-analysis.html#parameter-posterior-plots" target="_blank"><img src="figures/xsf_logo.png" alt="" class="img-fluid rounded-circle"></img></a>
        <p></p>
        <h1 class="specific"><a href="#welcome">XSF Tutorial</a></h1>
        <div class="social-links mt-3 text-center">
          <a href="mailto:peter.boorman@asu.cas.cz" class="email"><i class="bx bx-envelope"></i></a>
          <!-- <a href="https://twitter.com/boorm" class="twitter"><i class="bx bxl-twitter"></i></a> -->
          <!-- <a href="https://github.com/pboorm" class="github"><i class="bx bxl-github"></i></a> -->
          <!-- <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a> -->
          <!-- <a href="https://scholar.google.co.uk/citations?hl=en&user=KMBSQk0AAAAJ&view_op=list_works&gmla=AJsN-F7_Zd8SER40IpgqsThKe1j8238S_jmdhvl6o0_f8H2MzNxBQ774dnpndqenSKkK51UgPtJd1viFOjUek9fbEpgdq4ZIzQ" class="google-plus"><i class="ai ai-google-scholar"></i></a> -->
          <!-- <a href="https://linkedin.com/in/peter-boorman-5a745999" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
          <!-- <a href="https://orcid.org/0000-0001-9379-4716"><i class="fab fa-orcid"></i></a> -->
          <!-- <a href="https://ui.adsabs.harvard.edu/user/libraries/l9unchukSdu9eSTwLbnVVw" target="_blank"><i class="ai ai-ads"></i></a> -->
        </div>
      </div>

      <nav class="nav-menu">
        <ul>
          <li><a href="#welcome"><i class="bx bx-star"></i> <span>Welcome</span></a></li>
          <li><a href="#setup"><i class="icofont-fix-tools"></i> <span>Setup</span></a></li>
          <li><a href="#links"><i class="bx bx-bookmarks"></i> <span>Useful links</span></a></li>
          <li><a href="#session1"><i class="bx bx-terminal"></i>Session 1 - getting started</a></li>
          <li><a href="#ex11"><i class="bx bx-chevron-right"></i>1.1 - fit a model to data</a></li>
          <li><a href="#ex12"><i class="bx bx-chevron-right"></i>1.2 - explore a parameter space</a></li>
          <li><a href="#ex13"><i class="bx bx-chevron-right"></i>1.3 - compare models</a></li>
          <li><a href="#ex14"><i class="bx bx-chevron-right"></i>1.4 - scripting</a></li>
          <li><a href="#session2"><i class="bx bx-bar-chart-alt-2"></i> <span>Session 2 - more advanced concepts</span></a></li>
          <li><a href="#ex21"><i class="bx bx-chevron-right"></i> <span>2.1 - fitting multiple datasets simultaneously</span></a></li>
          <li><a href="#ex22"><i class="bx bx-chevron-right"></i> <span>2.2 - simulating data</span></a></li>
          <li><a href="#tipsandtricks"><i class="bx bx-bulb"></i> <span>Tips & tricks</span></a></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
        </ul>
      </nav><!-- .nav-menu -->
      <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

    </div>
  </header><!-- End Header -->

  <main id="main">

<!-- ======= Welcome Section ======= -->
    <section id="welcome" class="about">
      <div class="container">
        <div class="section-title">
            <h1><i class="bx bx-star"></i>&nbsp; <span class="typed" data-typed-items="Hello!, Dobrý den!, Kon'nichiwa!, Hallo!, Ciao!, Hola!, Mholweni!, Sawubona!, Marhaba!, Nǐ hǎo!, God dag!, Bonjour!, Shalom!, Namaste!, Zdravstvuyte!, Zdravo!, Ahoj!, Hallå!, Annyeonghaseyo!, Tena jistilign!, Moni!, Salama alaikum!, Ndêwó, Muraho!, Mbote!, Ki kati!, Malagasy!, Miarahaba!, Salibonani!, Dumêlang!, Ashamaa!, Dumela!, Mhoro!, Jambo!, Sawubona!, Selam!, Avuxeni!, Dumela!, Salaam aleekum, Molo!, Bawo!, Barev dzez!, Salam!, Assalamualaikum!, Nômoshkar!, Mingalarba!, Chum reap suor!, Néih hóu!, Kuzu-zangpo!, Gamarjoba!, Halo!, Salamatsyzby!, Sabaidee!, Namaskaram!, Sain baina uu!, Salaam!, Sat sri akal ji!, Āyubōvan!, Lí-hó!, Vaṇakkam!, Isänmesez!, Namaskārām!, Sà-wàt-dee!, Tashi delek!, Āssālam ‘alaykum!, Ässalamu läykum!, Assalomu aleykum!, Xin chào!, Tungjatjeta!, Kaixo!, Vitaju!, Demat!, Dobar dan!, Bok!, Tere!, Hyvää päivää!, Goeie!, Dia duit!, Halò!, Guten tag!, Yasass!, Szervusz!, Góðan dag!, Buon giorno!, Sveika!, Labas!, Moïen!, Dzień dobry!, Salut!, Živjo!, Dobriy den!, Helo!, A gutn tog!, As-salām ‘alaykum!, Merheba!, Merhaba!, Ni sa bula!, Aloha!, Tēnā koe!, Yokwe!, Alii!, Tālofa!, Ia ora na!, Gude!, Mālō e lelei!"></span></h1>
            <h3>Welcome to the X-ray Spectral Fitting tutorial page.</h3>
            </br>
          <p>The information and exercises on this page are to provide a sufficient background with <a href="" target="_blank">Xspec</a>/<a href="" target="_blank">PyXspec</a> and/or <a href="" target="_blank">Sherpa</a> to complete the <a href="tutorial_bxa.html" target="_blank">BXA tutorial exercises</a>, and is why the initial setup is the same as for that tutorial.</br></br>

            The exercises should also provide a good background for anyone interested in X-ray spectral fitting in general. But for a complete and in-depth understanding of the features available in <a href="" target="_blank">Xspec</a>/<a href="" target="_blank">PyXspec</a> and/or <a href="" target="_blank">Sherpa</a>, see the <a href="links">useful links</a> below for the excellent online material provided by the corresponding software teams.</p></br>
          <div class="col-lg-16">
            <a target="_blank" href="https://en.wikipedia.org/wiki/Levenberg–Marquardt_algorithm"><img src="figures/xsf_tutorial_banner.gif" class="img-fluid" alt=""></a>
          </div>
          </br>
          <p>For any questions/comments/suggestions concerning this tutorial, <a href="mailto:peter.boorman@asu.cas.cz" class="email">contact Peter Boorman</a>.</p>
        </div>
      </div>
    </section>
<!-- End Welcome Section -->


<section id="setup" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="icofont-fix-tools"></i> Setup <a class="headerlink" href="#setup" title="Permalink to this headline" style="font-size: 20px;"><i class="icofont-link-alt"></i></a></h2>

          <h3>&#9888;&#65039; <font color="red">WARNING!</font> &#9888;&#65039;
            <br>
            The exercises on this page require a working form of <a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/" target="_blank">Xspec</a>, <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/index.html">PyXspec</a> and/or <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/">Sherpa</a>.</h3>
          <p>Make sure either of these are installed before doing the exercises!</p>
          </br>

          <h3>For Xspec & PyXspec users</h3>
          <ul>
          <li>Install instructions for Xspec and PyXspec are available on the HEASoft website here:
            <br/>
            <a target="_blank" href="https://heasarc.gsfc.nasa.gov/docs/software/heasoft/">https://heasarc.gsfc.nasa.gov/docs/software/heasoft/</a>
            <br/>
            <b>Note using PyXspec requires a source distribution of HEASoft.</b>
          </li>
          

          <li>Once the install process has finished, check everthing is installed and works as required:&nbsp;
          <ul>
            <li>Check Xspec works: <code>$ xspec</code>
              <button class="cpbt" onclick="cx('xspec')"><i class="icofont-copy"></i></button>
            </li>
            <li>Check PyXspec works: <code>$ python -c 'import xspec'</code>
              <button class="cpbt" onclick="cx('python -c \'import xspec\'')"><i class="icofont-copy"></i></button>
            </li>
          </ul>
        </li>
          If no error messages come up from these commands, Xspec & PyXspec should work.
        </ul>
        </br></br>

          <h3>For Sherpa users</h3>
          <ul>
          <li>Install CIAO and Sherpa in a conda environment:<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/ciao/download/">https://cxc.cfa.harvard.edu/ciao/download/</a><br/></li>
          <li>Once the install process has finished, check Sherpa works:</br>
          <code><pre>
$ conda activate ciao-environment-name
$ sherpa</pre></code> <button class="cpbt" onclick="cx('conda activate ciao-environment-name\nsherpa')"><i class="icofont-copy"></i></button></br>

          If there are no errors, Sherpa should be working as expected.
          </li>
        </ul>

        </div>
      </div>
</section>

<section id="links" class="services">
      <div class="container">

        <div class="section-title">
          <h2><i class="bx bx-bookmarks"></i> Useful links <a class="headerlink" href="#links" title="Permalink to this headline" style="font-size: 20px;"><i class="icofont-link-alt"></i></a></h2>
          <h4>Documentation</h4>
          <ul>
          <li>Xspec documentation:
            <br/>
            <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/">https://heasarc.gsfc.nasa.gov/xanadu/xspec/</a>
          </li>
          <li>PyXspec documentation:
            <br/>
            <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/index.html">https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/index.html</a>
          </li>
          <li>Xspec wiki:
            <br/>
            <a target="_blank" href="https://asd.gsfc.nasa.gov/XSPECwiki/FrontPage">https://asd.gsfc.nasa.gov/XSPECwiki/FrontPage</a>
          </li>
          <li>Guide to the internal functions of Xspec:
            <br/>
            <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/internal/node1.html">https://heasarc.gsfc.nasa.gov/xanadu/xspec/internal/node1.html</a>
          </li>
          <li>Additional models for spectral fitting:
            <br>
            <a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/newmodels.html" target="_blank">https://heasarc.gsfc.nasa.gov/xanadu/xspec/newmodels.html</a>
          </li>
          <li>Sherpa reference for commands:<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html">https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html</a>
          </li>
        </ul>


          
          <h4>Places to ask questions</h4>
          <ul>
          <li>Xspec Facebook group:<br/><a target="_blank" href="https://www.facebook.com/groups/320119452570/?ref=share">https://www.facebook.com/groups/320119452570/?ref=share</a>
          </li>
          <li>Astrostatistics Facebook group:<br/><a target="_blank" href="https://www.facebook.com/groups/astro.r/?ref=share">https://www.facebook.com/groups/astro.r/?ref=share</a>
          </li>
          <li><a href="#contact">Email</a>!</li>
        </ul>

          
          <h4>Useful papers & documents</h4>
        <ul>
          <li>X-ray Data Primer by CXC:<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf">https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf</a>
          </li>
          <li>Information on C-statistics (&amp; modified C-statistics, aka W-stat) used in Xspec &amp; Sherpa by Giacomo Vianello:<br/><a target="_blank" href="https://giacomov.github.io/Bias-in-profile-poisson-likelihood/">https://giacomov.github.io/Bias-in-profile-poisson-likelihood/</a>
          </li>
        </ul>


          <h4>Lectures & videos</h4>
          <ul>
            <li>MPE workshop <i>X-ray spectral fitting methods</i> (2019):
              <ol>
                <li><a target="_blank" href="https://youtu.be/5keyHnuq0tk">https://youtu.be/5keyHnuq0tk</a></li>
                <li><a target="_blank" href="https://youtu.be/WylAz2nr0-4">https://youtu.be/WylAz2nr0-4</a></li>
                <li><a target="_blank" href="https://youtu.be/-e7lf1M8ONg">https://youtu.be/-e7lf1M8ONg</a></li>
              </ol>
            </li>
            <li>BiD4BEST Bayesian X-ray Spectral Analysis lectures by Johannes Buchner:<br/>
              <ol>
              <li><a target="_blank" href="https://youtu.be/_r4ecpje7nE">https://youtu.be/_r4ecpje7nE</a></li>
              <li><a href="https://youtu.be/EIzhDG-0Ji8">https://youtu.be/EIzhDG-0Ji8</a></li>
            </ol>
          </li>
          </ul>

          <h4>Scripts</h4>
          <ul>
          <li>Example PyXspec Jupyter notebooks provided by HEASARC:
            <br>
            <a target="_blank" href="https://github.com/HEASARC/PyXspec-Jupyter-notebooks">https://github.com/HEASARC/PyXspec-Jupyter-notebooks</a>
          </li>
          <li>Example for using PyXspec in Jupyter by Ivan Valtchanov:
            <br/>
            <a target="_blank" href="https://gist.github.com/ivvv/716799056b4aadc87e41097472edbd20">https://gist.github.com/ivvv/716799056b4aadc87e41097472edbd20</a>
          </li>
          <li>A collection of Sherpa python scripts:
            <br>
            <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/scripts/">https://cxc.cfa.harvard.edu/sherpa/scripts/</a>
          </li>
        </ul>

          <h4>Citations</h4>
          <ul>
          <li>Py/Xspec citation - Arnaud et al., (1996; ASPC):<br><a target="_blank" href="https://ui.adsabs.harvard.edu/abs/1996ASPC..101...17A/abstract">https://ui.adsabs.harvard.edu/abs/1996ASPC..101...17A/abstract</a>
          </li>
          <li>Sherpa citation - Freeman et al., (2001; SPIE):<br><a target="_blank" href="https://ui.adsabs.harvard.edu/abs/2001SPIE.4477...76F/abstract">https://ui.adsabs.harvard.edu/abs/2001SPIE.4477...76F/abstract</a></br>
          In CIAO 4.13, you can use this command to get information on the latest release:</br>
          <code>sherpa> sherpa.citation('latest')</code>&nbsp; <button class="cpbt" onclick="cx('sherpa.citation(\'latest\')')"><i class="icofont-copy"></i></button>
          </li>
          </ul>
          
          <li><b>Do you know of any others?</b> Please <a href="#contact">get in touch</a>!
          </li>
        </div>
</section>


<section id="session1" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="bx bx-terminal"></i> Session 1 - getting started</h2>
          <p>Key objectives:</p>
          <ul>
            <li>Load a spectrum and fit a model to it in Sherpa and/or Py/Xspec</li>
            <li>Explore a parameter space and test the goodness-of-fit</li>
            <li>Get to grips with plotting in Py/Xspec and Sherpa</li>
          </ul>
        </div>

          If you don't have your own, download the following Chandra/ACIS spectral files from <a href="bxa/s1_chandra.zip" download>here</a>:
        <ul>
          <li>Source spectrum (binned with <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/lheasoft/help/ftgrouppha.html">ftgrouppha</a> grouptype=bmin groupscale=1</code>): <code>sim_chan_bmin.pi</code></li>
          <li>Response: <code>chan.rmf</code></li>
          <li>Effective area: <code>chan.arf</code></li>
          <li>Background spectrum: <code>sim_chan_bkg.pi</code></li>
        </ul>
      </br>

          <h3>Getting started</h3>
          Here are some initial steps to set up a fit for BXA in PyXspec or Sherpa:
        <ul>
          <li>For interactive mode:
            <ul>
            <li>Xspec:
              <br>
              <code>$ xspec</code>&nbsp; <button class="cpbt" onclick="cx('xspec')"><i class="icofont-copy"></i></button>
            </li>
            <li>PyXspec:
              <br>
              <code><pre>
$ ipython
from xspec import *
</pre></code>
&nbsp; <button class="cpbt" onclick="cx('ipython\nfrom xspec import *')"><i class="icofont-copy"></i></button>
</li>
            <li>Sherpa:
              <br>
              <code>$ sherpa</code>&nbsp; <button class="cpbt" onclick="cx('sherpa')"><i class="icofont-copy"></i></button></li>
          </ul>
          </li></br>

          <li>For scripting:
            <ul>
            <li>Xspec:
              <br>
              <code>$ xspec - xspec_script.tcl</code></br>
            Remember to include <code>exit</code> or <code>quit</code> at the end of the script!</li>
            <li>PyXspec:
              <br>
              <code>$ python3 pyxspec_script.py</code></li>
            <li>Sherpa:
              <br>
              <code>$ sherpa sherpa_script.py</code></li>
          </ul>
          </li>

        </ul>
        </div>
</section>

<section id="ex11" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.1 - fit a model to data</h3>
        </div>

        Before starting, the following commands are required:
        <ul>
          <li>Set the fit statistic (here we use modified C-statistics):
            <ul>
          <li>Xspec:
            <br>
            <code>set stat cstat</code>&nbsp; <button class="cpbt" onclick="cx('set stat cstat')"><i class="icofont-copy"></i></button>
          </li>
          <li>PyXspec:
            <br>
            <code>Fit.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fitmanager.html#statMethod">statMethod</a> = "cstat"</code>
            &nbsp; <button class="cpbt" onclick="cx('Fit.statMethod(&quot;cstat&quot;')"><i class="icofont-copy"></i></button>
          </li>
          <li>Sherpa:
            <br>
            <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_stat.html">set_stat</a>("wstat")</code>
            &nbsp; <button class="cpbt" onclick="cx('set_stat(&quot;wstat&quot;')"><i class="icofont-copy"></i></button>
          </li>
        </ul>
          </li></br>

          <li>Set the x-axis units (e.g., instrument channels or energy):
            <ul>
            <li>Xspec:
              <br>
              <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node113.html#setplotenergy">setplot energy</a></code>&nbsp; <button class="cpbt" onclick="cx('setplot energy')"><i class="icofont-copy"></i></button></li>
          <li>PyXspec:
            <br>
            <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.xAxis</a> = "keV"# or "channel"</code>&nbsp; <button class="cpbt" onclick="cx('Plot.xAxis = &quot;keV&quot;')"><i class="icofont-copy"></i></button></li>
          <li>Sherpa:
            <br>
            <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_analysis.html">set_analysis</a>("ener")# or "chan"</code>&nbsp; <button class="cpbt" onclick="cx('set_analysis(&quot;ener&quot;)')"><i class="icofont-copy"></i></button></li>
        </ul>
          </li></br>

          <li>Plot device (Xspec & PyXspec only):
          <ul>
            <li>Xspec:</br>
            <ul>
              <li>Set the plot device: <code><a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node109.html" target="_blank">cpd</a> /xw</code>&nbsp; <button class="cpbt" onclick="cx('cpd /xw')"><i class="icofont-copy"></i></button></li>
            </ul>
          </li>
          <li>PyXspec:</br>
              <ul>
            <li>No plot device (useful to avoid plot window pop-ups): <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.device</a> = "/null"</code>&nbsp; <button class="cpbt" onclick="cx('Plot.device = &quot;null&quot;')"><i class="icofont-copy"></i></button></li>
            <li>Set the plot device: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.device</a> = "/xw"</code>&nbsp; <button class="cpbt" onclick="cx('Plot.device = &quot;/xw&quot;')"><i class="icofont-copy"></i></button></li>
          </ul>
          </ul>
          (other plot devices are available, see <a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node109.html" target="_blank">here</a>)
          </li><br>
        </ul>

        Next, we load in the data and ignore ineffective energies:
        <ul>
          <li>Load spectra:
          <ul>
            <li>Xspec:</br>
              <code>data 1:1 sim_chan_bmin1.pi</code>&nbsp; <button class="cpbt" onclick="cx('data 1:1 sim_chan_bmin1.pi')"><i class="icofont-copy"></i></button></br>
            </li>
          <li>PyXspec:</br>
              <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/spectrum.html">Spectrum</a>("sim_chan_bmin1.pi")</code>&nbsp; <button class="cpbt" onclick="cx('s = Spectrum(&quot;sim_chan_bmin1.pi&quot;)')"><i class="icofont-copy"></i></button></br>
              Or:</br>
              <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>("1:1 sim_chan_bmin1.pi")</code>&nbsp; <button class="cpbt" onclick="cx('s = AllData(&quot;1:1 sim_chan_bmin1.pi&quot;)')"><i class="icofont-copy"></i></button>
            </li>
          <li>Sherpa:</br>
            <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "sim_chan_bmin1.pi")</code>&nbsp; <button class="cpbt" onclick="cx('load_pha(1, &quot;sim_chan_bmin1.pi&quot;)')"><i class="icofont-copy"></i></button></li>
          </ul>
          </li></br>

          <li>Ignore ineffective energies:
            <ul>
          <li>Xspec:</br>
            <code>ignore 1:0.-0.5 8.-**</code>&nbsp; <button class="cpbt" onclick="cx('ignore 1:0.-0.5 8.-**')"><i class="icofont-copy"></i></button></br>
          </li>
          <li>PyXspec:</br>
            <code>s.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html">ignore</a>("0.-0.5 8.-**")</code>&nbsp; <button class="cpbt" onclick="cx('s.ignore(&quot;0.-0.5 8.-**&quot;)')"><i class="icofont-copy"></i></button></br>
            Or:</br>
            <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.ignore("1:0.-0.5 8.-**")</code>&nbsp; <button class="cpbt" onclick="cx('AllData.ignore(&quot;0.-0.5 8.-**&quot;)')"><i class="icofont-copy"></i></button>
          </li>
          <li>Sherpa:</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(1, "0.:0.5,8.:")</code>&nbsp; <button class="cpbt" onclick="cx('ignore_id(1, &quot;0.:0.5,8.:&quot;)')"><i class="icofont-copy"></i></button></li>
          </ul>
        </li></br>
      </ul>

      Then we create a simple <code>powerlaw</code> model and set the model parameter values:
      <ul>
          <li>Create the model:
            <ul>
          <li>Xspec:</br>
          <code>model powerlaw</code>&nbsp; <button class="cpbt" onclick="cx('model powerlaw')"><i class="icofont-copy"></i></button>
        </li>
          <li>PyXspec:</br>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code>&nbsp; <button class="cpbt" onclick="cx('mymod=Model(&quot;powerlaw&quot;)')"><i class="icofont-copy"></i></button></li>
          <li>Sherpa:</br>
            <code><pre id="sherpa_create_model">
mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod)
</pre></code>&nbsp; <button class="cpbt" onclick="cx('mymod = xspowerlaw.mypow\nset_source(1, mymod)')"><i class="icofont-copy"></i></button></br>
          Note <code>xs</code> is used to indicate Xspec models, and <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_default_id.html">get_default_id()</a></code> can be used to show the id that is used if an id is not specified</li>
          </ul>
          </li></br>

          <li>Set the parameter values:
          </br>
            Note the <code>min</code>, <code>max</code> parameter bounds are used in the BXA priors and should be set to reasonable values.</br>
          <ul>
          <li>Xspec:</br>
          <code><pre id="xspec_set_par_values">
newpar 1 1.9, 0.1, -1., -1., 4., 4.
newpar 2 1.e-3, 0.1, 1.e-8, 1.e-8, 1., 1.
</pre></code>&nbsp; <button class="cpbt" onclick="cp('xspec_set_par_values')"><i class="icofont-copy"></i></button>
</li>
          <li>PyXspec:</br>
          <code><pre id="pyxspec_set_par_values">
mymod.powerlaw.PhoIndex.values = (1.9, 0.1, -1., -1., 4., 4.)
mymod.powerlaw.norm.values = (1.e-3, 0.1, 1.e-8, 1.e-8, 1., 1.)
</pre></code>&nbsp; <button class="cpbt" onclick="cp('pyxspec_set_par_values')"><i class="icofont-copy"></i></button>
</li>
          Or:</br>
          <code><pre>
<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(1).values = 1.9, 0.1, -1., -1., 4., 4.
<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(2).values = 1.e-3, 0.1, 1.e-8, 1.e-8, 1., 1.
</pre></code>&nbsp; <button class="cpbt" onclick="cx('AllModels(1)(1).values = 1.9, 0.1, -1., -1., 4., 4.\nAllModels(1)(2).values = 1.e-3, 0.1, 1.e-8, 1.e-8, 1., 1.')"><i class="icofont-copy"></i></button></li>          
          <li>Sherpa:</br>
            <code><pre>
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mypow.phoindex, val=1.9, min=-1., max=4.)
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mypow.norm, val=1.e-3, min=1.e-8, max=1.)
</pre></code>&nbsp; <button class="cpbt" onclick="cx('set_par(mypow.phoindex, val=1.9, min=-1., max=4.)\nset_par(mypow.norm, val=1.e-3, min=1.e-8, max=1.)')"><i class="icofont-copy"></i></button></li>
          </ul>
          </li>
        </ul>


        Then all that remains is to fit the model to the data
        <ul>
        </ul>
        </div>
</section>

<section id="ex12" class="services">
      <div class="container">
        <div class="section-title">
          <!-- <ul> -->
            <h3><i class="bx bx-chevron-right"></i> Exercise 1.2 - explore a parameter space</h3>
          </div>
        <ul>
          <li>steppar</li>
          <li>chain</li>

        </ul>
          </br>
        </div>
</section>

<section id="ex13" class="services">
      <div class="container">
        <div class="section-title">
            <h3><i class="bx bx-chevron-right"></i> Exercise 1.3 - compare models</h3>
          </div>
          
          <ul>
            <li>Goodness-of-fit</li>
            <li>Visually</li>
          </ul>
          </br>
      </div>
</section>


<section id="ex15" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.4 - scripting</h3>
        </div>

        <ul>
          <li>tcl</li>
          </ul>
      </div>
</section>




<section id="session2" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="bx bx-bar-chart-alt-2"></i> Session 2 - more advanced concepts</h2>
          Key objectives:
          <ul>
          <li>Fit multiple datasets simultaneously</li>
          <li>Simulating data</li>
          <li>More complex models?</li>
          <li>Systematic uncertainty?</li>
          <li>Others?</li>
        </ul>
        </div>
        </div>
</section>

<section id="ex21" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 2.1 - fitting multiple datasets simultaneously</h3>
          <p><em>Sometimes it is advantageous to fit multiple spectra for the same source simultaneously with e.g., a cross-calibration constant to account for instrumental differences in the separate spectra.</em></p>
        </div>
          For this example, we need another dataset. As an example, we will use a NuSTAR/FPMA spectrum which has a bandpass that extends to E &gt; 10 keV. So including this data with our Chandra spectral analysis will extend the energy range we can study our source over to ~78 keV. To download the NuSTAR spectral files:
          <ul>
          <li>Source spectrum (<code>sim_nuA_bmin.pi</code>) & background spectrum (<code>sim_nuA_bkg.pi</code>) <a href="bxa/ex16_nustar.zip" download>here</a>.</li>
          <li>Response (<code>nustar.rmf</code>) and effective area (<code>point_30arcsecRad_1arcminOA.arf</code>) files from the <a href="https://www.nustar.caltech.edu/system/media_files/binaries/32/original/nustar_point_sources_for_proposers.tgz?1404172745">Point source simulation files</a> (distributed by the NuSTAR team, more info <a target="_blank" href="https://www.nustar.caltech.edu/page/response_files">here</a>).</li>
          </li>
        </ul></br>

        We first assume that the source was not variable between the Chandra and NuSTAR observations, and thus only account for differences arising from the calibration of either instrument.
        <ul>
          <li>First, include a cross-calibration constant in your model between the Chandra and NuSTAR datasets:</br>
          <ul>
          <li>PyXspec:</br>
          <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>("1:1 sim_nuA_bmin1.pi 2:2 sim_chan_bmin1.pi")</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.ignore("1:0.-3. 78.-** 2:0.-0.5 8.-**")</code><br/>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node235.html">constant</a> * <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(1).values = (1., -0.01)</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(2)(1).values = (1., 0.01, 0.01, 0.01, 10., 10.)</code></li>
          <li>Sherpa:</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "sim_nuA_bmin1.pi")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(1, "0.:3.,78.:")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(2, "sim_chan_bmin1.pi")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(2, "0.:0.5,8.:")</code></br>
          <code>mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow</code></br>
          <code>mymod1 = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xsconstant.html">xsconstant</a>("xcal1") * mymod</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(xcal1, val=1, frozen=True)</code></br>
          <code>mymod2 = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xsconstant.html">xsconstant</a>("xcal2") * mymod</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(xcal2, val=1, min = 1.e-2, max = 1.e2)</code></br>
          <!-- <code>Parameter_kwargs = {"modelname": 'crosscal', "name": "logC2", "val": np.log10(xcal2), "min": -2., "max": 2.}</code></br>
          <code>logXcal2 = Parameter(**Parameter_kwargs)</code></br>
          <code>set_par(crossCalID.factor, val = 10 ** logXcal2)</code></br> -->
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod1)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(2, mymod2)</code></br>
          </li>
        </ul></li></br>
          
        </ul></li></br>

          </ul>
        </div>
</section>

<section id="ex21" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 2.2 - simulating data</h3>
          These exercises involve simulating spectra. To do this, you will need a response file (rmf), an effective area file (arf) and (optionally) a background spectrum file:

          <ul>
          <li>PyXspec (using <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">fakeit</a></code>):</br>
          <blockquote>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code><br/>
          <code>mymod.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>.PhoIndex.values = (1.9, 0.01, -3., -3., 3., 3.)</code><br/>
          <code>mymod.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>.norm.values = (1.e-3, 0.01, 1.e-8, 1.e-8, 1., 1.)</code><br/>
          <code>fakeit_kwargs = {}</code></br>
          <code>fakeit_kwargs["response"] = "chan.rmf"</code></br>
          <code>fakeit_kwargs["arf"] = "chan.arf"</code></br>
          <code>fakeit_kwargs["background"] = "chan_bkg.pi"</code></br>
          <code>fakeit_kwargs["exposure"] = 30.e3</code></br>
          <code>fakeit_kwargs["correction"] = "1."</code></br>
          <code>fakeit_kwargs["backExposure"] = 30.e3</code></br>
          <code>fakeit_kwargs["fileName"] = "sim_chan.pi"</code></br>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">fakeit</a>(1, <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">FakeitSettings</a>(**fakeit_kwargs))</code></br>
          </li>
          <li>Sherpa (using <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/fake_pha.html">fake_pha</a></code>):</br>
          <blockquote>
          <code>mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mymod.phoindex, val = 1.9, min = -3., max = 3.)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mymod.norm, val = 1.e-3, min = 1.e-8, max = 1.)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "chan_src.pi") #loading pre-exising source spectrum with rmf, arf & bkg present</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod)</code>
          <code>fakepha_kwargs = {}</code></br>
          <code>fakepha_kwargs["rmf"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_rmf.html">get_rmf</a>()</code></br>
          <code>fakepha_kwargs["arf"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_arf.html">get_arf</a>()</code></br>
          <code>fakepha_kwargs["bkg"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_bkg.html">get_bkg</a>()</code></br>
          <code>fakepha_kwargs["exposure"] = 30.e3</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/fake_pha.html">fake_pha</a>(1, **fakepha_kwargs)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/save_pha.html">save_pha</a>(1, "sim_chan.pi", clobber = True)</code></br>
          </li>
          </ul>
        </div>
</section>


<section id="tipsandtricks" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="bx bx-bulb"></i>Tips & tricks <a class="headerlink" href="#tipsandtricks" title="Permalink to this headline" style="font-size: 20px;"><i class="icofont-link-alt"></i></a></h2>
        </div>
        <ul>
          <li>
          To find the version of your bxa install:</br>
          <code><pre>
import <a target="_blank" href="https://github.com/JohannesBuchner/BXA">bxa</a>, <a target="_blank" href="https://nsoranzo-galaxy.readthedocs.io/en/stable/lib/pkg_resources.html">pkg_resources</a>
print(pkg_resources.<a target="_blank" href="https://nsoranzo-galaxy.readthedocs.io/en/stable/_modules/pkg_resources.html#get_distribution">get_distribution</a>("bxa").version)
</pre></code>
&nbsp; <button class="cpbt" onclick="cx('import bxa, pkg_resources\nprint(pkg_resources.get_distribution(&quot;bxa&quot;).version)')"><i class="icofont-copy"></i></button>
          </li></br>
          <li>For complex fits (e.g., multiple datasets simultaneously, many parameters, high signal-to-noise spectra, ...), the run time can be decreased with e.g.,:</br>
            <ul>
          <li><code>results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.xspec.html#bxa.xspec.solver.BXASolver.run">run</a>(frac_remain=0.5, max_num_improvement_loops=0)</code> <button class="cpbt" onclick="cx('results = solver.run(frac_remain=0.5, max_num_improvement_loops=0)')"><i class="icofont-copy"></i></button>
            <br>
            <ul>
            <li><code>frac_remain</code> sets the cut-off condition for the integration. A low value is optimal for finding peaks but higher values (e.g., 0.5) can be used if the posterior distribution is a relatively simple shape.
            </li>
            <li><code>max_num_improvement_loops</code> sets the number of times <code>run()</code> will try to iteratively assess how many more samples are needed.
            </li>
            <li>To see the other arguments of <code>run()</code>, see <a href="https://johannesbuchner.github.io/UltraNest/ultranest.html#module-ultranest.integrator" target="_blank">here</a>.
            </li>
          </ul>
          <!-- <li>Step-samplers</li> -->
          </li></br>
          <li>If you're sure you want to, you can use BXA with chi-squared statistics:</br>
          <code>bxa.BXASolver.allowed_stats.append("chi2")</code>&nbsp; <button class="cpbt" onclick="cx('bxa.BXASolver.allowed_stats.append(&quot;chi2&quot;)')"><i class="icofont-copy"></i></button>
          </li></br>

          <li>You can create custom priors in BXA with <code><a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/5a6ee5fafbaf7bc609a29dafadae48d27aba50aa/bxa/xspec/priors.py#L75">create_custom_prior_for</a>()</code> (example taken from <a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/master/examples/xspec/example_advanced_priors.py">example_advanced_prior.py</a>):</br>
          PyXspec:<br>
          <code><pre>
def <a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/master/examples/xspec/example_advanced_priors.py#L27">my_custom_prior</a>(u):
    # prior distributions transform from 0:1 to the parameter range
    # here: a gaussian prior distribution, cut below 1/above 3
    x = <a target="_blank" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">scipy.stats.norm</a>(1.9, 0.15).ppf(u)
    if x < 1.:
        x = 1
    if x > 3:
        x = 3
    return x
transformations = [bxa.<a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/5a6ee5fafbaf7bc609a29dafadae48d27aba50aa/bxa/xspec/priors.py#L75">create_custom_prior_for</a>(model, parameter, my_custom_prior)]
</pre></code>
&nbsp; <button class="cpbt" onclick="cx('def my_custom_prior(u):\n    # prior distributions transform from 0:1 to the parameter range\n    # here: a gaussian prior distribution, cut below 1/above 3\n    x = scipy.stats.norm(1.9, 0.15).ppf(u)\n    if x < 1.:\n        x = 1\n    if x > 3:\n        x = 3\n    return x\ntransformations = [bxa.create_custom_prior_for(model, parameter, my_custom_prior)]')"><i class="icofont-copy"></i></button>
          </li><br>

          <li>You can use BXA with Sherpa to fit 2D models to images:</br>
              <code><pre>
import bxa.sherpa as bxa
<a target="_blank" href="https://cxc.harvard.edu/sherpa/ahelp/load_image.html">load_image</a>("image.fits")
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/image_data.html">image_data</a>()
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_coord.html">set_coord</a>("physical")
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_stat.html">set_stat</a>("cash")
model = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/gauss2d.html">gauss2d</a>.g1 + <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/gauss2d.html">gauss2d</a>.g2 + <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/const2d.html">const2d</a>.bg
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(model)
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(g1.ampl, val = 20., min = 1., max = 1.e2)
...
parameters = [g1.ampl, ...]
priors = [bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/xspec/priors.html#create_loguniform_prior_for">create_loguniform_prior_for</a>(g1.ampl), ...]
priorfunction = bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/priors.html#create_prior_function">create_prior_function</a>(priors)
solver = bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/sherpa-analysis.html#bxa.sherpa.solver.BXASolver">BXASolver</a>(prior=priorfunction, parameters=parameters, outputfiles_basename = "fit2d_sherpa")
results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.xspec.html#bxa.xspec.solver.BXASolver.run">run</a>(resume=True)
<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/image_data.html">image_data</a>()
<a target="_blank" href="https://cxc.harvard.edu/sherpa/ahelp/image_model.html">image_model</a>(newframe=True)
<a target="_blank" href="https://cxc.harvard.edu/sherpa4.6/ahelp/image_resid.html">image_resid</a>(newframe=True)
</pre></code>&nbsp; <button class="cpbt" onclick="cx('import bxa.sherpa as bxa\nload_image(&quot;image.fits&quot;)\nimage_data()\nset_coord(&quot;physical&quot;)\nset_stat(&quot;cash&quot;)\nmodel = gauss2d.g1 + gauss2d.g2 + const2d.bg\nset_source(model)\nset_par(g1.ampl, val = 20., min = 1., max = 1.e2)\n...\nparameters = [g1.ampl, ...]\npriors = [bxa.create_loguniform_prior_for(g1.ampl), ...]\npriorfunction = bxa.create_prior_function(priors)\nsolver = bxa.BXASolver(prior=priorfunction, parameters=parameters, outputfiles_basename = &quot;fit2d_sherpa&quot;)\nresults = solver.run(resume=True)\nimage_data()\nimage_model(newframe=True)\nimage_resid(newframe=True)')"><i class="icofont-copy"></i></button>
<br><br>
              Here is an example fit to the image used in <a target="_blank" href="https://cxc.harvard.edu/sherpa/threads/spatial/">this Sherpa tutorial for 2D fitting</a> (left, middle and right panels show the image, best-fit model and residuals respectively):
              <br><br>
              <div class="col-lg-8">
                <img src="bxa/ds9_fit2d_sherpa.png" class="img-fluid" alt="">
              </div>
          </li></br>
          
        </ul>
        </div>
</section>

<section id="contact" class="contact">
      <div class="container">

        <div class="section-title">
          <h2><i class="bx bx-envelope"></i> Contact</a> <a class="headerlink" href="#contact" title="Permalink to this headline" style="font-size: 20px;"><i class="icofont-link-alt"></i></a></h2>
        </div>

                <div class="row">

          <div class="col-lg-6">
            <div class="info">
                  <i class="icofont-question"></i>
                <h4>Helpdesks</h4>
                <br>
                <ul>
                  <li><a href="https://github.com/JohannesBuchner/BXA/issues" target="_blank">Py/Xspec</a></li>
                  <li><a href="https://github.com/JohannesBuchner/UltraNest/issues" target="_blank">Sherpa</a></li>

              </div>
            </div>

          <div class="col-lg-6">
            <div class="info">
              <i class="icofont-envelope"></i>
                <h4>Email</h4>
                <br>
                <p>For questions/comments/suggestions for this page, e-mail Peter Boorman on boorman[at]asu.cas.cz</li></p>
            </div>
            </div>
          </div>


          
      </div>
</section>


</main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">
      <div class="social-links mt-3 text-left">
          <a href="xsf22.html"><i class="bx bx-arrow-back"></i></a>
        </div>
      <!-- <div class="copyright">
        <a target="_blank" href="https://peterboorman.com"><i class="bx bx-arrow-back"></i> </a>
      </div> -->
      <!-- <div class="credits"> -->
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/ -->
        <!-- Design: <a href="https://bootstrapmade.com/">BootstrapMade</a> -->
      <!-- </div> -->
    </div>
  </footer>
  <!-- End  Footer -->

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>