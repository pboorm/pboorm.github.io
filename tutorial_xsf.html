<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Using academicons -->
  <!-- <link rel="stylesheet" href="assets/academicons-1.9/css/academicons.min.css"/> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <!-- Using fontawesome -->
  <script src="https://kit.fontawesome.com/f5e5434f52.js" crossorigin="anonymous"></script>


  <!-- <link rel="apple-touch-icon" href="./favicon.ico" /> -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>XSF Tutorial</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
  <!-- <meta content="" name="description"> -->
  <!-- <meta content="" name="keywords"> -->
  <meta property="og:title" content="XSF Tutorial" />
  <meta property="og:locale" content="en_UK" />
  <meta name="description" content="XSF Tutorial" />
  <meta property="og:description" content="XSF Tutorial" />
  <link rel="canonical" href="https://peterboorman.com/" />
  <meta property="og:url" content="https://peterboorman.com/" />
  <meta property="og:site_name" content="XSF Tutorial" />
  <script type="application/ld+json">
  {"@type":"WebSite","headline":"XSF Tutorial","url":"https://peterboorman.com/tutorial_bxa.html","description":"XSF Tutorial","name":"XSF Tutorial","@context":"https://schema.org"}</script>

  <!-- Favicons -->
  <!-- <link href="assets/img/favicon.png" rel="icon"> -->
  <link href="favicon.ico" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: iPortfolio - v1.4.1
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">
      <div class="profile">
        <a href="http://johannesbuchner.github.io/BXA/xspec-analysis.html#parameter-posterior-plots" target="_blank"><img src="figures/xsf_logo.png" alt="" class="img-fluid rounded-circle"></img></a>
        <p></p>
        <h1 class="specific"><a href="#welcome">XSF Tutorial</a></h1>
        <div class="social-links mt-3 text-center">
          <a href="mailto:peter.boorman@asu.cas.cz" class="email"><i class="bx bx-envelope"></i></a>
          <!-- <a href="https://twitter.com/boorm" class="twitter"><i class="bx bxl-twitter"></i></a> -->
          <!-- <a href="https://github.com/pboorm" class="github"><i class="bx bxl-github"></i></a> -->
          <!-- <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a> -->
          <!-- <a href="https://scholar.google.co.uk/citations?hl=en&user=KMBSQk0AAAAJ&view_op=list_works&gmla=AJsN-F7_Zd8SER40IpgqsThKe1j8238S_jmdhvl6o0_f8H2MzNxBQ774dnpndqenSKkK51UgPtJd1viFOjUek9fbEpgdq4ZIzQ" class="google-plus"><i class="ai ai-google-scholar"></i></a> -->
          <!-- <a href="https://linkedin.com/in/peter-boorman-5a745999" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
          <!-- <a href="https://orcid.org/0000-0001-9379-4716"><i class="fab fa-orcid"></i></a> -->
          <!-- <a href="https://ui.adsabs.harvard.edu/user/libraries/l9unchukSdu9eSTwLbnVVw" target="_blank"><i class="ai ai-ads"></i></a> -->
        </div>
      </div>

      <nav class="nav-menu">
        <ul>
          <li><a href="#welcome"><i class="bx bx-star"></i> <span>Welcome</span></a></li>
          <li><a href="#setup"><i class="icofont-fix-tools"></i> <span>Setup</span></a></li>
          <li><a href="#links"><i class="bx bx-bookmarks"></i> <span>Useful links</span></a></li>
          <li><a href="#session1"><i class="bx bx-terminal"></i>Session 1 - getting started</a></li>
          <li><a href="#ex11"><i class="bx bx-chevron-right"></i>1.1 - loading & fitting data</a></li>
          <li><a href="#ex12"><i class="bx bx-chevron-right"></i>1.2 - comparing fits</a></li>
          <li><a href="#ex13"><i class="bx bx-chevron-right"></i>1.3 - visualisation</a></li>
          <li><a href="#session2"><i class="bx bx-bar-chart-alt-2"></i> <span>Session 2 - more advanced</span></a></li>
          <li><a href="#ex21"><i class="bx bx-chevron-right"></i> <span>2.1 - multiple spectra</span></a></li>
          <li><a href="#ex22"><i class="bx bx-chevron-right"></i> <span>2.2 - simulating</span></a></li>
          <li><a href="#ex23"><i class="bx bx-chevron-right"></i> <span>2.3 - model verification</span></a></li>
          <li><a href="#tipsandtricks"><i class="bx bx-bulb"></i> <span>Tips & tricks</span></a></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
          <li><p>&nbsp; </p></li>
        </ul>
      </nav><!-- .nav-menu -->
      <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

    </div>
  </header><!-- End Header -->

  <main id="main">

<!-- ======= Welcome Section ======= -->
    <section id="welcome" class="about">
      <div class="container">
        <div class="section-title">
            <h1><i class="bx bx-star"></i>&nbsp; <span class="typed" data-typed-items="Hello!, Dobrý den!, Kon'nichiwa!, Hallo!, Ciao!, Hola!, Mholweni!, Sawubona!, Marhaba!, Nǐ hǎo!, God dag!, Bonjour!, Shalom!, Namaste!, Zdravstvuyte!, Zdravo!, Ahoj!, Hallå!, Annyeonghaseyo!, Tena jistilign!, Moni!, Salama alaikum!, Ndêwó, Muraho!, Mbote!, Ki kati!, Malagasy!, Miarahaba!, Salibonani!, Dumêlang!, Ashamaa!, Dumela!, Mhoro!, Jambo!, Sawubona!, Selam!, Avuxeni!, Dumela!, Salaam aleekum, Molo!, Bawo!, Barev dzez!, Salam!, Assalamualaikum!, Nômoshkar!, Mingalarba!, Chum reap suor!, Néih hóu!, Kuzu-zangpo!, Gamarjoba!, Halo!, Salamatsyzby!, Sabaidee!, Namaskaram!, Sain baina uu!, Salaam!, Sat sri akal ji!, Āyubōvan!, Lí-hó!, Vaṇakkam!, Isänmesez!, Namaskārām!, Sà-wàt-dee!, Tashi delek!, Āssālam ‘alaykum!, Ässalamu läykum!, Assalomu aleykum!, Xin chào!, Tungjatjeta!, Kaixo!, Vitaju!, Demat!, Dobar dan!, Bok!, Tere!, Hyvää päivää!, Goeie!, Dia duit!, Halò!, Guten tag!, Yasass!, Szervusz!, Góðan dag!, Buon giorno!, Sveika!, Labas!, Moïen!, Dzień dobry!, Salut!, Živjo!, Dobriy den!, Helo!, A gutn tog!, As-salām ‘alaykum!, Merheba!, Merhaba!, Ni sa bula!, Aloha!, Tēnā koe!, Yokwe!, Alii!, Tālofa!, Ia ora na!, Gude!, Mālō e lelei!"></span></h1>
            <h3>Welcome to the X-ray Spectral Fitting tutorial page.</h3>
            </br>
          <p>The information and exercises on this page are to provide a sufficient background with <a href="" target="_blank">Xspec</a>/<a href="" target="_blank">PyXspec</a> and/or <a href="" target="_blank">Sherpa</a> to complete the <a href="tutorial_bxa.html" target="_blank">BXA tutorial exercises</a>, and is why the initial setup is the same as for that tutorial.</br></br>

            The exercises should also provide a good background for anyone interested in X-ray spectral fitting in general. But for a complete and in-depth understanding of the features available in <a href="" target="_blank">Xspec</a>/<a href="" target="_blank">PyXspec</a> and/or <a href="" target="_blank">Sherpa</a>, see the <a href="links">useful links</a> below for the excellent online material provided by the corresponding software teams.</p></br>
          <div class="col-lg-16">
            <a target="_blank" href="https://en.wikipedia.org/wiki/Levenberg–Marquardt_algorithm"><img src="figures/xsf_tutorial_banner.gif" class="img-fluid" alt=""></a>
          </div>
          </br>
          <p>For any questions/comments/suggestions concerning this tutorial, <a href="mailto:peter.boorman@asu.cas.cz" class="email">contact Peter Boorman</a>.</p>
        </div>
      </div>
    </section>
<!-- End Welcome Section -->


<section id="setup" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="icofont-fix-tools"></i> Setup</h2>

          <h3>&#9888;&#65039; <font color="red">WARNING</font> &#9888;&#65039; BXA requires a working form of <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/index.html">PyXspec</a> and/or <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/">Sherpa</a>.</h3>
          <p>Make sure either of these are installed before doing the exercises!</p>
          </br>

          <h2>For PyXspec users</h2>
          <li>Using a conda environment (e.g. with <a target="_blank" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a>) should ensure no conflicts occur when installing the Python packages required for BXA.</li>
          <li>Using PyXspec with BXA may require a source distribution of HEASoft. See install instructions here:<br/><a target="_blank" href="https://heasarc.gsfc.nasa.gov/docs/software/heasoft/">https://heasarc.gsfc.nasa.gov/docs/software/heasoft/</a><br/></li>
          <li>Once the install process has finished, check PyXspec works by typing:
            <blockquote><p><code>$ conda activate bxa</code> (if using a specific conda environment, otherwise skip this step)<br/>
            <code>$ python -c 'from xspec import *'</code></p>
          </blockquote>
          </li>

          <h2>For Sherpa users</h2>
          <li>Install instructions for CIAO and Sherpa (optionally in a conda environment):<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/ciao/download/">https://cxc.cfa.harvard.edu/ciao/download/</a><br/></li>
          <li>Once the install process has finished, check Sherpa works by typing:
          <blockquote><p><code>$ conda activate ciao</code><br/>
          <code>$ sherpa</code></p>
          </blockquote>
          </li>

          <h2>BXA installation</h2>
          <li>BXA package documentation with installation instructions:<br/><a target="_blank" href="https://johannesbuchner.github.io/BXA/#installation">https://johannesbuchner.github.io/BXA/#installation</a></li>
          <li>Check BXA was installed correctly:<br/>
          PyXspec:<br/><blockquote><p><code>$ python -c 'import ultranest'</code><br/>
          <code>$ python -c 'from xspec import *'</code><br/>
          <code>$ python -c 'import bxa.xspec as bxa'</code><br/></p>
          </blockquote>
          Sherpa:<br/><blockquote><p><code>$ python -c 'import ultranest'</code><br/>
          <code>$ python -c 'import bxa.sherpa as bxa'</code></p>
          </blockquote>
          </li>
        </div>
      </div>
</section>

<section id="links" class="services">
      <div class="container">

        <div class="section-title">
          <h2><i class="bx bx-bookmarks"></i> Useful links</h2>
          <li>Xspec &amp; PyXspec documentation:<br/><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/">https://heasarc.gsfc.nasa.gov/xanadu/xspec/</a><br/>
          </li>
          </br>
          <li>Xspec Facebook group:<br/><a target="_blank" href="https://www.facebook.com/groups/320119452570/?ref=share">https://www.facebook.com/groups/320119452570/?ref=share</a><br/>
          </li>
          </br>
          <li>Sherpa reference for commands:<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html">https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html</a><br/>
          </li>
          </br>
          <li>Astrostatistics Facebook group:<br/><a target="_blank" href="https://www.facebook.com/groups/astro.r/?ref=share">https://www.facebook.com/groups/astro.r/?ref=share</a><br/>
          </li>
          </br>
          <li>X-ray Data Primer by CXC:<br/><a target="_blank" href="https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf">https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf</a><br/>
          </li>
          </br>
          <li>Information on C-statistics (&amp; modified C-statistics, aka W-stat) used in Xspec &amp; Sherpa by Giacomo Vianello:<br/><a target="_blank" href="https://giacomov.github.io/Bias-in-profile-poisson-likelihood/">https://giacomov.github.io/Bias-in-profile-poisson-likelihood/</a><br/>
          </li>
          </br>
          <li>Py/Xspec citation - Arnaud et al., (1996; ASPC):<br><a target="_blank" href="https://ui.adsabs.harvard.edu/abs/1996ASPC..101...17A/abstract">https://ui.adsabs.harvard.edu/abs/1996ASPC..101...17A/abstract</a><br/>
          </li>
          </br>
          <li>Sherpa citation - Freeman et al., (2001; SPIE):<br><a target="_blank" href="https://ui.adsabs.harvard.edu/abs/2001SPIE.4477...76F/abstract">https://ui.adsabs.harvard.edu/abs/2001SPIE.4477...76F/abstract</a><br/>
          In CIAO 4.13, you can use this command to get information on the latest release:</br>
          <code>sherpa> sherpa.citation("latest")</code>
          </li>
          </br>
          <li>Do you know of any others? Please get in touch!
          </li>
          </br>
        </div>
</section>


<section id="session1" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="bx bx-terminal"></i> Session 1 - getting started</h2>
          <p>Key objectives:</p>
          <ul>
            <li>Load a dataset and fit a model to it in Sherpa and/or Py/Xspec</li>
            <li>Explore a parameter space and test the goodness-of-fit</li>
            <li>Get to grips with plotting in Py/Xspec and Sherpa</li>
          </ul>
        </div>

          If you don't have your own, download the following Chandra/ACIS spectral files from <a href="bxa/s1_chandra.zip" download>here</a>:
        <ul>
          <li>Source spectrum (binned with <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/lheasoft/help/ftgrouppha.html">ftgrouppha</a> grouptype=bmin groupscale=1</code>): <code>sim_chan_bmin.pi</code></li>
          <li>Response: <code>chan.rmf</code></li>
          <li>Effective area: <code>chan.arf</code></li>
          <li>Background spectrum: <code>sim_chan_bkg.pi</code></li>
        </ul>
      </br>

          <h3>Getting started</h3>
          Here are some initial steps to set up a fit for BXA in PyXspec or Sherpa:
        <ul>
          <li>For interactive mode:
            <ul>
            <li>Xspec: <code>$ xspec</code></li>
            <li>PyXspec: <code>$ ipython</code></li>
            <li>Sherpa: <code>$ sherpa</code></li>
          </ul>
          </li></br>

          <li>For scripting:
            <ul>
            <li>Xspec: <code>$ xspec - xspec_script.tcl</code></br>
            (remember to have exit or quit at the end of the script!)</li>
            <li>PyXspec: <code>$ python3 pyxspec_script.py</code></li>
            <li>Sherpa: <code>$ sherpa sherpa_script.py</code></li>
          </ul>
          </li></br>

          <li>Setup required packages (PyXspec and Sherpa only):
            <ul>
              <li>PyXspec:</br>
          <code>from xspec import *</code></br>
          <code>import bxa.xspec as bxa</code><br/>
        </li>
          <li>Sherpa:</br>
          <code>import bxa.sherpa as bxa</code>
        </li>
      </ul>
          </li>

          

        </ul>
        </div>
</section>

<section id="ex11" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.1 - fit a model to data</h3>
        </div>

        Here are the commands needed to set initial settings, load data and fit a model:
        <ul>
          <li>Set the statistic (here we use modified C-statistics):
            <ul>
          <li>Xspec: <code>set stat cstat</code></li>
          <li>PyXspec: <code>Fit.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fitmanager.html#statMethod">statMethod</a> = "cstat"</code></li>
          <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_stat.html">set_stat</a>("wstat")</code></li>
        </ul>
          </li></br>

          <li>Set the x-axis units (e.g., instrument channels or energy):
            <ul>
            <li>Xspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node113.html">setplot</a> <a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node113.html#setplotchannel" target="_blank">channel</a></code> (or <code><a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node113.html#setplotenergy" target="_blank">energy</a></code>)</li>
            <li>PyXspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.xAxis</a> = "channel"# or "keV"</code></li>
            <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_analysis.html">set_analysis</a>("chan")# or "ener"</code></li>
        </ul>
          </li></br>

          <li>Plot device (Xspec & PyXspec only):
          <ul>
            <li>No plot device (useful to avoid plot window pop-ups): <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.device</a> = "/null"</code></li>
          <li>Set the plot device: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/plotmanager.html">Plot.device</a> = "/xw"</code></li>
          </ul>
          </li></br>

          <li>Load spectra:
          <ul>
            <li>PyXspec:</br>
              <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/spectrum.html">Spectrum</a>("sim_chan_bmin.pi")</code></br>
              or <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>("1:1 sim_chan_bmin1.pi")</code>)</li>
          <li>Sherpa:</br>
            <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "sim_chan_bmin.pi")</code></li>
          </ul>
          </li></br>

          <li>Ignore channels:
            <ul>
          <li>Pyxspec:</br>
            <code>s.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html">ignore</a>("0.-0.5 8.-**")</code></br>
            or <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.ignore("1:0.-0.5 8.-**")</code></li>
          <li>Sherpa:</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(1, "0.:0.5,8.:")</code></li>
          </ul>
        </li></br>

          <li>Create a model:
            <ul>
          <li>PyXspec:</br>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code></li>
          <li>Sherpa:</br>
          <code>mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow</code> (<code>xs</code> is used to indicate Xspec models)</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod)</code></br>
          (<code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_default_id.html">get_default_id()</a></code> can be used to show the default id that is used if an id is not specified)</li>
          </ul>
          </li></br>

          <li>Set parameters (note the <code>min</code>, <code>max</code> parameter bounds are used in the BXA priors):
          <ul>
          <li>PyXspec:</br>
          <code>mymod.powerlaw.PhoIndex.values = (value, delta, min, bottom, top, max)</code><br/>
          <code>mymod.powerlaw.norm.values = (value, delta, min, bottom, top, max)</code></br>
          Or:</br>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(1).values = ...</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(2).values = ...</code></li>
          
          <li>Sherpa:</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mypow.phoindex, val=value, min=min, max=max)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mypow.norm, val=value, min=min, max=max)</code></li>
          </ul>
          </li>
        </ul>
        </div>
</section>

<section id="ex12" class="services">
      <div class="container">
        <div class="section-title">
          <!-- <ul> -->
            <h3><i class="bx bx-chevron-right"></i> Exercise 1.2 - fit a model to a spectrum</h3>
          </div>
        Now that we have checked the priors look reasonable for the data we want to fit, we can fit the model to the data with BXA.
        <ul>
          <li>First fit the model using Levenberg-Marquadt included in Xspec &amp; Sherpa:
            <ul>
              <li>PyXspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fitmanager.html">Fit</a>.perform()</code></li>
          <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/fit.html">fit</a>()</code></li>
          </ul>
        </li></br>

          <li>Is the fit good? How can you tell? What does changing the parameters by a small amount do?</li></br>

          <li>Next perform the fit with BXA (note this does not require fitting with Levenberg-Marquadt first):
            <ul>
          <li>PyXspec: <code>results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.xspec.html#bxa.xspec.solver.BXASolver.run">run</a>(resume=True)</code></li>
          <li>Sherpa: <code>results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.sherpa.html#bxa.sherpa.solver.BXASolver.run">run</a>(resume=True)</code> (note different hyperlinks)</li>
          </ul>
          <code>results</code> contains the posterior samples (<code>results["samples"]</code>) for each parameter and the Bayesian evidence (<code>results["logZ"]</code>, <code>results["logZerr"]</code>). The quantities should also be printed to the screen after the fit is completed.</br>
          To understand more about the information <a target="_blank" href="https://johannesbuchner.github.io/UltraNest/readme.html">UltraNest</a> prints to the screen during and after a fit, see <a target="_blank" href="https://johannesbuchner.github.io/UltraNest/performance.html">here</a>.
          </li></br>

          <li>Examine the best-fit values and uncertainties from the posterior samples. This can be done with <code><a target="_blank" href="https://pandas.pydata.org">pandas</a></code> (may require installing with e.g., conda):</br>
          <code>import <a target="_blank" href="https://pandas.pydata.org">pandas</a> as pd</code></br>
          <code>df = pd.<a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">DataFrame</a>(data=results["samples"], columns=solver.paramnames)</code></br>
          <code>df.head()</code>
          </li></br>
          <li>How do the best-fits and confidence ranges compare with using nested sampling vs. Levenberg-Marquadt?</li>
          </ul>
          </br>
        </div>
</section>

<section id="ex13" class="services">
      <div class="container">
        <div class="section-title">
            <h3><i class="bx bx-chevron-right"></i> Exercise 1.3 - fit and compare multiple models</h3>
            <em>Here we use the Bayesian evidence to perform model comparison with Bayes factors.</em>
          </div>
          
          <ul>
          <li>Note to use <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node264.html">TBabs</a>, one should set the abundances to those from <a target="_blank" href="https://ui.adsabs.harvard.edu/abs/2000ApJ...542..914W/abstract">Wilms, Allen &amp; McCray (2000)</a>:
          <ul>
          <li>PyXspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/xspecsettings.html">Xset.abund</a> = "wilm"</code></li>
          <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_xsabund.html">set_xsabund</a>("wilm")</code></li></br>
          </ul>
        </li>

          <li>Fit the following additional 2 models to the data with BXA (don't forget to give unique <code>outputfiles_basename</code> values!):
            <ol>
          <li>Absorbed powerlaw:</br>
            <ul>
          <li>PyXspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node264.html">TBabs</a> * <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a></code></li>
          <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa4.3/ahelp/xstbabs.html">xstbabs</a> * <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a></code></li>
        </ul></li>
          <li>Absorbed powerlaw + Gaussian emission line (assume the emission line for this source is known to have line centroid energy <code>LineE</code> = 6.3 &plusmn; 0.15 keV, and that the line is narrow with fixed width <code>Sigma</code> = 1 eV):</br>
            <ul>
          <li>PyXspec: <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node264.html">TBabs</a> * <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a> + <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node175.html">gaussian</a></code></li>
          <li>Sherpa: <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa4.3/ahelp/xstbabs.html">xstbabs</a> * <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a> + <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xsgaussian.html">xsgaussian</a></code></li>
        </ul></br>
      </li>
          </ol>
          </li>

          <li>Copy the <a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/master/examples/xspec/model_compare.py">model_compare.py</a> script to your working directory to perform Bayesian evidence model comparison</li></br>

          <li>Run the script: <code>$ python3 model_compare.py outputfiles_basename1/ outputfiles_basename2/ outputfiles_basename3/</code></li></br>

          <li>Compute the <a target="_blank" href="https://en.wikipedia.org/wiki/Akaike_information_criterion">Akaike Information Criterion (AIC)</a> for each model in python:</br>
          <code>import <a target="_blank" href="https://docs.python.org/3/library/json.html">json</a></code></br>
          <code>basenames = [outputfiles_basename1, outputfiles_basename2, outputfiles_basename3]</code></br>
          <code>loglikes = <a target="_blank" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>([(f, json.<a target="_blank" href="https://docs.python.org/3/library/json.html#json.load">load</a>(open(f + "/info/results.json"))['maximum_likelihood']["logl"]) for f in basenames])</code></br>
          <code>dofs = <a target="_blank" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>([(f, len(json.<a target="_blank" href="https://docs.python.org/3/library/json.html#json.load">load</a>(open(f + "/info/results.json"))['paramnames'])) for f in basenames])</code></br>
          <code>aic = <a target="_blank" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>([(basename, (2. * dofs[basename] - 2. * loglike)) for basename, loglike in loglikes.items()])</code></br>
          </li></br>

          <li>Which model best explains the data? Why?</li>

          </ul>
          </br>
      </div>
</section>

<section id="ex14" class="services">
      <div class="container">
        <div class="section-title">
            <h3><i class="bx bx-chevron-right"></i> Exercise 1.4 - error propagation</h3>
            <em>By generating quantities directly from the posterior samples, we propagate the uncertainties and conserve any structure (e.g., degeneracies, multiple modes).</em>
          </div>

          As an example, we will estimate the equivalent width of the emission line used in the Absorbed powerlaw + Gaussian model above.
          <ul>
          <li>The equivalent width (<code>EW</code> below) of an emission line is defined as the flux in the line divided by the flux of the continuum at the line energy (see the <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node95.html">Xspec documentation</a> for more information).</li></br>
          
          <li>For the model we have used, the equivalent width of the emission line relative to the intrinsic (i.e. unabsorbed) powerlaw continuum is (in terms of the parameters defined):
            <ul>
          <li>PyXspec: <code>EW = (mymod.gaussian.norm / mymod.powerlaw.norm) * mymod.gaussian.LineE ** mymod.powerlaw.PhoIndex</code></li>
          <li>Sherpa: <code>EW = (line.norm / mypow.norm) * line.linee ** mypow.phoindex</code></li>
          </ul>
         Generate posterior samples for equivalent width. If using pandas, this will involve creating a new column in the pandas dataframe of posterior samples for the equivalent width.
        </li></br>

          <li>Use the <code>results["samples"]</code> to derive the posterior distribution on equivalent width for the emission line component. If using pandas:</br>
          <code>import <a target="_blank" href="https://corner.readthedocs.io/en/latest/pages/quickstart.html">corner</a></code></br>
          <code>figure = corner.corner(df, labels = df.columns, quantiles = [0.16, 0.5, 0.84], show_titles = True)</code>
          </li></br>
          
          <li>Is the equivalent width degenerate with any other parameters? Why or why not?</li>
          </ul>
        </div>
</section>

<section id="ex15" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.5 - visualisation</h3>
        </div>
        We want a simple way to check that our model makes sense, that the fit worked, and to infer information on the source being fit.</br></br>

        <ul>
          <li> First, examine the corner and trace plots that BXA produces (located in <code>outputfiles_basename/plots/</code>). What do these plots show?</li></br>

          <li>Are there any parameter degeneracies? Why or why not?</li></br>

          <li>Create a <a target="_blank" href="https://johannesbuchner.github.io/BXA/xspec-analysis.html#model-discovery">Quantile-Quantile</a> (also <a target="_blank" href="https://en.wikipedia.org/wiki/Q–Q_plot">here</a> for a more general explanation) plot for your fits:
            <ul>
          <li>PyXspec (produces plot):</br>
          <code>import <a target="_blank" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.html">matplotlib.pyplot</a> as plt</code></br>
          <code>print('creating quantile-quantile plot ...')</code></br>
          <code>plt.<a target="_blank" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html">figure</a>(figsize=(7,7))</code></br>
          <code>with bxa.XSilence():</code></br>
          <code>&nbsp; &nbsp; solver.set_best_fit()</code></br>
          <code>&nbsp; &nbsp; bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/xspec/qq.html">qq.qq</a>(prefix=outputfiles_basename, markers=5, annotate=True)</code></br>
          <code>print('saving plot...')</code></br>
          <code>plt.<a target="_blank" href="https://matplotlib.org/2.2.5/api/_as_gen/matplotlib.pyplot.savefig.html">savefig</a>(outputfiles_basename + 'qq_model_deviations.pdf', bbox_inches='tight')</code></br>
          <code>plt.<a target="_blank" href="https://matplotlib.org/2.1.0/api/_as_gen/matplotlib.pyplot.close.html">close</a>()</code></li>
          <li>Sherpa (produces file that needs to be plotted separately):</br>
          <code>bxa.qq.<a target="_blank" href="http://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/qq.html#qq_export">qq_export</a>(1, bkg=False, outfile=outputfiles_basename + "_qq", elow=0.2, ehigh=10)</code></li>
          </ul>
          </li></br>

          <div class="col-lg-16">
            <img src="bxa//qq_plots.png" class="img-fluid" alt="">
          </div>

          <li>What does the <code>powerlaw</code> model Q-Q plot show? Is this model lacking any components?</li></br>

          <li>(PyXspec only) Produce a plot of posterior model spectra (<a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/13824b292018e8ffaac9024886bc713334fd7051/examples/xspec/example_simplest.py#L36">convolved</a> and <a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/13824b292018e8ffaac9024886bc713334fd7051/examples/xspec/example_simplest.py#L65">unconvolved</a>) using the code in the <a target="_blank" href="https://github.com/JohannesBuchner/BXA/blob/master/examples/xspec/example_simplest.py">example_simplest.py</a> script included in BXA. Which energies is the model best-constrained over?</li></br>
          </br>
      </div>
</section>

<section id="ex16" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.6 - fitting multiple datasets simultaneously with BXA</h3>
          <p><em>Sometimes it is advantageous to fit multiple spectra for the same source simultaneously with e.g., a cross-calibration constant to account for instrumental differences in the separate spectra.</em></p>
        </div>
          For this example, we need another dataset. As an example, we will use a NuSTAR/FPMA spectrum which has a bandpass that extends to E &gt; 10 keV. So including this data with our Chandra spectral analysis will extend the energy range we can study our source over to ~78 keV. To download the NuSTAR spectral files:
          <ul>
          <li>Source spectrum (<code>sim_nuA_bmin.pi</code>) & background spectrum (<code>sim_nuA_bkg.pi</code>) <a href="bxa/ex16_nustar.zip" download>here</a>.</li>
          <li>Response (<code>nustar.rmf</code>) and effective area (<code>point_30arcsecRad_1arcminOA.arf</code>) files from the <a href="https://www.nustar.caltech.edu/system/media_files/binaries/32/original/nustar_point_sources_for_proposers.tgz?1404172745">Point source simulation files</a> (distributed by the NuSTAR team, more info <a target="_blank" href="https://www.nustar.caltech.edu/page/response_files">here</a>).</li>
          </li>
        </ul></br>

        We first assume that the source was not variable between the Chandra and NuSTAR observations, and thus only account for differences arising from the calibration of either instrument.
        <ul>
          <li>First, include a cross-calibration constant in your model between the Chandra and NuSTAR datasets:</br>
          <ul>
          <li>PyXspec:</br>
          <code>s = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>("1:1 sim_nuA_bmin1.pi 2:2 sim_chan_bmin1.pi")</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.ignore("1:0.-3. 78.-** 2:0.-0.5 8.-**")</code><br/>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/node235.html">constant</a> * <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(1)(1).values = (1., -0.01)</code><br/>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">AllModels</a>(2)(1).values = (1., 0.01, 0.01, 0.01, 10., 10.)</code></li>
          <li>Sherpa:</br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "sim_nuA_bmin1.pi")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(1, "0.:3.,78.:")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(2, "sim_chan_bmin1.pi")</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/ignore_id.html">ignore_id</a>(2, "0.:0.5,8.:")</code></br>
          <code>mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow</code></br>
          <code>mymod1 = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xsconstant.html">xsconstant</a>("xcal1") * mymod</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(xcal1, val=1, frozen=True)</code></br>
          <code>mymod2 = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xsconstant.html">xsconstant</a>("xcal2") * mymod</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(xcal2, val=1, min = 1.e-2, max = 1.e2)</code></br>
          <!-- <code>Parameter_kwargs = {"modelname": 'crosscal', "name": "logC2", "val": np.log10(xcal2), "min": -2., "max": 2.}</code></br>
          <code>logXcal2 = Parameter(**Parameter_kwargs)</code></br>
          <code>set_par(crossCalID.factor, val = 10 ** logXcal2)</code></br> -->
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod1)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(2, mymod2)</code></br>
          </li>
        </ul></li></br>
          <li>Fit the new model with BXA and derive a posterior confidence range on the cross-calibration constant:</br>
          <ul>
          <li>PyXspec:</br>
          <code>transformations.append(bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/xspec/priors.html#create_loguniform_prior_for">create_loguniform_prior_for</a>(AllModels(2), AllModels(2).constant.factor))</code><br/>
          <code>solver = bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/xspec/solver.html#BXASolver">BXASolver</a>(transformations=transformations, outputfiles_basename="xcal_pl_pyxspec")</code><br/>
          <code>results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.xspec.html#bxa.xspec.solver.BXASolver.run">run</a>(resume=True)</code></li>
          <li>Sherpa:</br>
          <code>priors.append(bxa.create_loguniform_prior_for(xcal2))</code></br>
          <code>parameters.append(xcal2)</code></br>
          <code>solver = bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/sherpa-analysis.html#bxa.sherpa.solver.BXASolver">BXASolver</a>(prior=bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/priors.html#create_prior_function">create_prior_function</a>([prior1, prior2, ...]), parameters=[param1, param2, ...], outputfiles_basename="xcal_pl_sherpa")</code></br>
          <code>results = solver.<a target="_blank" href="https://johannesbuchner.github.io/BXA/bxa.sherpa.html#bxa.sherpa.solver.BXASolver.run">run</a>(resume=True)</code><br/>
          </li>
        </ul></li></br>

          <li>How have the confidence ranges on all the parameters changed after including NuSTAR?</li></br>

          <li>How have the Bayes factors between different model fits changed? Why?</li></br>
          </ul>
        </div>
</section>

<section id="ex17" class="services">
      <div class="container">
        <div class="section-title">
          <h3><i class="bx bx-chevron-right"></i> Exercise 1.7 - (Sherpa only) automated background fitting with BXA</h3>
        </div>

        So far, the exercises have used modified C-statistics (aka W-statistics) in which the background is modelled as a stepwise function with the same number of parameters as bins. This process typically requires some form of minimal binning (see discussion <a target="_blank" href="https://giacomov.github.io/Bias-in-profile-poisson-likelihood/">here</a>).</br></br>

          Using C-statistics can be more flexible, since no binning is required by simultaneously fitting a background model instead. Here we use the <code><a target="_blank" href="https://johannesbuchner.github.io/BXA/pca-background-models.html">auto_background</a></code> function in BXA, which provides a powerful way to implement background models in Sherpa, and simultaneously fit with a source model using BXA.</br></br>

          <ul>
          <li>Load the data, source model and priors as in Exercise 1.1 (make sure to also change the statistic from <code>wstat</code> to <code>cstat</code>!)</li></br>

          <li>Load the automatic PCA background model (see <a target="_blank" href="https://ui.adsabs.harvard.edu/abs/2018A%26A...618A..66S/abstract">Simmonds et al., 2018</a> for more information):</br>
          <code>from bxa.sherpa.background.pca import <a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/background/pca.html#auto_background">auto_background</a></code><br/>
          <code><a target="_blank" href="https://cxc.harvard.edu/sherpa/ahelp/set_model.html">set_model</a>(1, model)</code><br/>
          <code>convmodel = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_model.html">get_model</a>(1)</code><br/>
          <code>bkg_model = <a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/background/pca.html#auto_background">auto_background</a>(1)</code><br/>
          <code><a target="_blank" herf="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_full_model.html">set_full_model</a>(1, convmodel + bkg_model*<a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_bkg_scale.html">get_bkg_scale</a>(1))</code></p>
          </li>

          <li>Remember to include the zeroth order component from the PCA background model in the priors and parameters list so that BXA knows to vary it as a free parameter:</br>
          <code>parameters += [bkg_model.pars[0]]</code><br/>
          <code>priors += [bxa.<a target="_blank" href="https://johannesbuchner.github.io/BXA/_modules/bxa/sherpa/priors.html#create_uniform_prior_for">create_uniform_prior_for</a>(bkg_model.pars[0])]</code>
          </li></br>

          <li>Fit the source + background model with BXA</li></br>

          <li>Check the background fit (e.g., with <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/plot_bkg_fit.html">get_bkg_fit</a></code>, <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/plot_bkg_fit_ratio.html">get_bkg_fit_ratio</a></code>, <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/plot_bkg_fit_resid.html">get_bkg_fit_resid</a></code>).</li></br>

          <li>Have the uncertainty ranges changed at all for the parameters? Why or why not?</li>
        </ul>
      </div>
</section>

<section id="session2" class="services">
      <div class="container">
        <div class="section-title">
          <h2><i class="bx bx-bar-chart-alt-2"></i> Session 2 - more advanced concepts</h2>
          Key objectives:
          <ul>
          <li>Combine individual posteriors to constrain a population</li>
          <li>Calibrate model selection thresholds with simulations</li>
          <li>Perform model verification to test the Goodness-of-Fit</li>
        </ul>
        </div>

          These exercises involve simulating spectra. To do this, you will need a response file (rmf), an effective area file (arf) and (optionally) a background spectrum file:

          <ul>
          <li>PyXspec (using <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">fakeit</a></code>):</br>
          <blockquote>
          <code>mymod = <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/model.html">Model</a>("<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>")</code><br/>
          <code>mymod.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>.PhoIndex.values = (1.9, 0.01, -3., -3., 3., 3.)</code><br/>
          <code>mymod.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelPowerlaw.html">powerlaw</a>.norm.values = (1.e-3, 0.01, 1.e-8, 1.e-8, 1., 1.)</code><br/>
          <code>fakeit_kwargs = {}</code></br>
          <code>fakeit_kwargs["response"] = "chan.rmf"</code></br>
          <code>fakeit_kwargs["arf"] = "chan.arf"</code></br>
          <code>fakeit_kwargs["background"] = "chan_bkg.pi"</code></br>
          <code>fakeit_kwargs["exposure"] = 30.e3</code></br>
          <code>fakeit_kwargs["correction"] = "1."</code></br>
          <code>fakeit_kwargs["backExposure"] = 30.e3</code></br>
          <code>fakeit_kwargs["fileName"] = "sim_chan.pi"</code></br>
          <code><a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/datamanager.html#datamanager-label">AllData</a>.<a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">fakeit</a>(1, <a target="_blank" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/python/html/fakeitsettings.html">FakeitSettings</a>(**fakeit_kwargs))</code></br>
          </li>
          <li>Sherpa (using <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/fake_pha.html">fake_pha</a></code>):</br>
          <blockquote>
          <code>mymod = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html">xspowerlaw</a>.mypow</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mymod.phoindex, val = 1.9, min = -3., max = 3.)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_par.html">set_par</a>(mymod.norm, val = 1.e-3, min = 1.e-8, max = 1.)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/load_pha.html">load_pha</a>(1, "chan_src.pi") #loading pre-exising source spectrum with rmf, arf & bkg present</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/set_source.html">set_source</a>(1, mymod)</code>
          <code>fakepha_kwargs = {}</code></br>
          <code>fakepha_kwargs["rmf"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_rmf.html">get_rmf</a>()</code></br>
          <code>fakepha_kwargs["arf"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_arf.html">get_arf</a>()</code></br>
          <code>fakepha_kwargs["bkg"] = <a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/get_bkg.html">get_bkg</a>()</code></br>
          <code>fakepha_kwargs["exposure"] = 30.e3</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/fake_pha.html">fake_pha</a>(1, **fakepha_kwargs)</code></br>
          <code><a target="_blank" href="https://cxc.cfa.harvard.edu/sherpa/ahelp/save_pha.html">save_pha</a>(1, "sim_chan.pi", clobber = True)</code></br>
          </li>
          </ul>
        </div>
</section>


</main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">
      <div class="social-links mt-3 text-left">
          <a href="xsf22.html"><i class="bx bx-arrow-back"></i></a>
        </div>
      <!-- <div class="copyright">
        <a target="_blank" href="https://peterboorman.com"><i class="bx bx-arrow-back"></i> </a>
      </div> -->
      <!-- <div class="credits"> -->
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/ -->
        <!-- Design: <a href="https://bootstrapmade.com/">BootstrapMade</a> -->
      <!-- </div> -->
    </div>
  </footer>
  <!-- End  Footer -->

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>