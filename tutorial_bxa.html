<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Using academicons -->
  <!-- <link rel="stylesheet" href="assets/academicons-1.9/css/academicons.min.css"/> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <!-- Using fontawesome -->
  <script src="https://kit.fontawesome.com/f5e5434f52.js" crossorigin="anonymous"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-180765826-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-180765826-1');
  </script>


  <!-- <link rel="apple-touch-icon" href="./favicon.ico" /> -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>BXA Tutorial</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
  <!-- <meta content="" name="description"> -->
  <!-- <meta content="" name="keywords"> -->
  <meta property="og:title" content="BXA Tutorial" />
  <meta property="og:locale" content="en_UK" />
  <meta name="description" content="BXA Tutorial" />
  <meta property="og:description" content="BXA Tutorial" />
  <link rel="canonical" href="https://peterboorman.com/" />
  <meta property="og:url" content="https://peterboorman.com/" />
  <meta property="og:site_name" content="BXA Tutorial" />
  <script type="application/ld+json">
  {"@type":"WebSite","headline":"BXA Tutorial","url":"https://peterboorman.com/tutorial_bxa.html","description":"BXA Tutorial","name":"BXA Tutorial","@context":"https://schema.org"}</script>

  <!-- Favicons -->
  <!-- <link href="assets/img/favicon.png" rel="icon"> -->
  <link href="favicon.ico" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: iPortfolio - v1.4.1
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">
      <div class="profile">
        <!-- <img src="assets/img/code-alt-inv.png" alt="" class="img-fluid rounded-circle"> -->
        <p></p>
        </br>
        <h1 class="text-light"><a href="index.html">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BXA Tutorial</a></h1>
        <div class="social-links mt-3 text-center">
          <a href="mailto:peter.boorman@asu.cas.cz" class="email"><i class="bx bx-envelope"></i></a>
          <!-- <a href="https://twitter.com/boorm" class="twitter"><i class="bx bxl-twitter"></i></a> -->
          <!-- <a href="https://github.com/pboorm" class="github"><i class="bx bxl-github"></i></a> -->
          <!-- <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a> -->
          <!-- <a href="https://scholar.google.co.uk/citations?hl=en&user=KMBSQk0AAAAJ&view_op=list_works&gmla=AJsN-F7_Zd8SER40IpgqsThKe1j8238S_jmdhvl6o0_f8H2MzNxBQ774dnpndqenSKkK51UgPtJd1viFOjUek9fbEpgdq4ZIzQ" class="google-plus"><i class="ai ai-google-scholar"></i></a> -->
          <!-- <a href="https://linkedin.com/in/peter-boorman-5a745999" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
          <!-- <a href="https://orcid.org/0000-0001-9379-4716"><i class="fab fa-orcid"></i></a> -->
          <!-- <a href="https://ui.adsabs.harvard.edu/user/libraries/l9unchukSdu9eSTwLbnVVw" target="_blank"><i class="ai ai-ads"></i></a> -->
        </div>
      </div>

      <nav class="nav-menu">
        <ul>
          <li><a href="#welcome"><i class="bx bx-upside-down"></i> <span>Welcome</span></a></li>
          <li><a href="#setup"><i class="icofont-fix-tools"></i> <span>Setup</span></a></li>
          <li><a href="#links"><i class="bx bx-bookmarks"></i> <span>Useful links</span></a></li>
          <li><a href="#session1"><i class="bx bx-terminal"></i>Session 1 - beginners</a></li>
          <li><a href="#session2"><i class="bx bx-terminal"></i> <span>Session 2 - advanced</span></a></li>
        </ul>
      </nav><!-- .nav-menu -->
      <button type="button" class="mobile-nav-toggle d-xl-none"><i class="icofont-navigation-menu"></i></button>

    </div>
  </header><!-- End Header -->

  <main id="main">

<!-- ======= Welcome Section ======= -->
    <section id="welcome" class="about">
      <div class="container">
        <div class="section-title">
          <ul>
            <h2><i class="bx bx-upside-down"></i>&nbsp; <span class="typed" data-typed-items="Hello!, Dobrý den!, Kon'nichiwa!, Hallo!, Ciao!, Hola!, Mholweni!, Sawubona!, Marhaba!, Nǐ hǎo!, God dag!, Bonjour!, Shalom!, Namaste!, Zdravstvuyte!, Zdravo!, Ahoj!, Hallå!, Annyeonghaseyo!, Tena jistilign!, Moni!, Salama alaikum!, Ndêwó, Muraho!, Mbote!, Ki kati!, Malagasy!, Miarahaba!, Salibonani!, Dumêlang!, Ashamaa!, Dumela!, Mhoro!, Jambo!, Sawubona!, Selam!, Avuxeni!, Dumela!, Salaam aleekum, Molo!, Bawo!, Barev dzez!, Salam!, Assalamualaikum!, Nômoshkar!, Mingalarba!, Chum reap suor!, Néih hóu!, Kuzu-zangpo!, Gamarjoba!, Halo!, Salamatsyzby!, Sabaidee!, Namaskaram!, Sain baina uu!, Salaam!, Sat sri akal ji!, Āyubōvan!, Lí-hó!, Vaṇakkam!, Isänmesez!, Namaskārām!, Sà-wàt-dee!, Tashi delek!, Āssālam ‘alaykum!, Ässalamu läykum!, Assalomu aleykum!, Xin chào!, Tungjatjeta!, Kaixo!, Vitaju!, Demat!, Dobar dan!, Bok!, Tere!, Hyvää päivää!, Goeie!, Dia duit!, Halò!, Guten tag!, Yasass!, Szervusz!, Góðan dag!, Buon giorno!, Sveika!, Labas!, Moïen!, Dzień dobry!, Salut!, Živjo!, Dobriy den!, Helo!, A gutn tog!, As-salām ‘alaykum!, Merheba!, Merhaba!, Ni sa bula!, Aloha!, Tēnā koe!, Yokwe!, Alii!, Tālofa!, Ia ora na!, Gude!, Mālō e lelei!"></span></h2>
            <h3>Welcome to the Bayesian X-ray Analysis (BXA) tutorial page for the Chandra Data Science meeting.</h3>
            </br>
          </ul>
          <ul><p>BXA connects Xspec/Sherpa to nested sampling algorithms for Bayesian parameter estimation and model comparison with the Bayesian evidence.</p></ul>
          <div class="col-lg-16">
            <img src="assets/img/bayestheorem.pdf" class="img-fluid" alt="">
          </div>
          </br>
          <!-- <div class="col-lg-16">
            <img src="assets/img/xrayfitting.pdf" class="img-fluid" alt="">
          </div>
          </br>
          <ul><p>X-ray fitting uses forward folding to constrain model parameters.</p></ul> -->
          <ul><p>For any questions/comments/suggestions concerning the tutorial, contact Peter Boorman and/or Johannes Buchner on Slack or by e-mail.</p></ul>
        </div>
      </div>
    </section>
<!-- End Welcome Section -->


<section id="setup" class="services">
      <div class="container">

        <div class="section-title">
          <ul><h2><i class="icofont-fix-tools"></i> Setup</h2>

          <h3>&#9888;&#65039; <font color="red">WARNING</font> &#9888;&#65039; BXA requires a working form of PyXspec and/or Sherpa.</h3>
          <p>Make sure either of these are installed before doing the exercises!</p>
          </br>

          <h2>For PyXspec users</h2><ul>
          <li>Using a conda environment (e.g. with <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a>) should ensure no conflicts occur when installing the Python packages required for BXA.</li>
          <li>Using PyXspec with BXA may require a source distribution of HEASOFT. See install instructions here:<br/><a href="https://heasarc.gsfc.nasa.gov/docs/software/heasoft/">https://heasarc.gsfc.nasa.gov/docs/software/heasoft/</a><br/></li>
          <li>Once the install process has finished, check PyXspec works by typing:
            <blockquote><p><code>$ conda activate bxa</code> (if using a specific conda environment, otherwise skip this step)<br/>
            <code>$ python -c 'from xspec import *'</code></p>
          </blockquote>
          </li>
        </ul>

          <h2>For Sherpa users</h2><ul>
          <li>Install instructions for CIAO and Sherpa (optionally in a conda environment):<br/><a href="https://cxc.cfa.harvard.edu/ciao/download/">https://cxc.cfa.harvard.edu/ciao/download/</a><br/></li>
          <li>Once the install process has finished, check Sherpa works by typing:
          <blockquote><p><code>$ conda activate ciao</code><br/>
          <code>$ sherpa</code></p>
          </blockquote>
          </li>
          </ul>

          <h2>BXA installation</h2><ul>
          <li>BXA package documentation with installation instructions:<br/><a href="https://johannesbuchner.github.io/BXA/#installation">https://johannesbuchner.github.io/BXA/#installation</a>
          <li>Check BXA was installed correctly:<br/><ul>
          <li>PyXspec:<br/><blockquote><p><code>$ python -c 'import ultranest'</code><br/>
          <code>$ python -c 'from xspec import *'</code><br/>
          <code>$ python -c 'import bxa.xspec as bxa'</code><br/></p>
          </blockquote>
          </li>
          <li>Sherpa:<br/><blockquote><p><code>$ python -c 'import ultranest'</code><br/>
          <code>$ python -c 'import bxa.sherpa as bxa'</code></p>
          </blockquote>
          </li>
          </ul>
          </li>
          </ul>



          </ul>

        </div>
</section>

<section id="links" class="services">
      <div class="container">

        <div class="section-title">
          <ul><h2><i class="bx bx-bookmarks"></i> Useful links</h2><ul>
          <li><p>Xspec &amp; PyXspec documentation:<br/><a href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/">https://heasarc.gsfc.nasa.gov/xanadu/xspec/</a><br/></p>
          </li>
          </br>
          <li><p>Xspec Facebook group:<br/><a href="https://www.facebook.com/groups/320119452570/?ref=share">https://www.facebook.com/groups/320119452570/?ref=share</a><br/></p>
          </li>
          </br>
          <li><p>Sherpa reference for commands:<br/><a href="https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html">https://cxc.cfa.harvard.edu/sherpa/ahelp/sherpa4.html</a><br/></p>
          </li>
          </br>
          <li><p>Astrostatistics Facebook group:<br/><a href="https://www.facebook.com/groups/astro.r/?ref=share">https://www.facebook.com/groups/astro.r/?ref=share</a><br/></p>
          </li>
          </br>
          <li><p>X-ray Data Primer by CXC:<br/><a href="https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf">https://cxc.cfa.harvard.edu/cdo/xray_primer.pdf</a><br/></p>
          </li>
          </br>
          <li><p>Information on C-statistics (&amp; modified C-statistics) used in Xspec &amp; Sherpa by Giacomo Vianello:<br/><a href="https://giacomov.github.io/Bias-in-profile-poisson-likelihood/">https://giacomov.github.io/Bias-in-profile-poisson-likelihood/</a><br/></p>
          </li>
          </br>
          <li><p>X-ray Spectral Fitting lectures by Johannes Buchner:<br/><a href="https://youtu.be/_r4ecpje7nE">https://youtu.be/_r4ecpje7nE</a><br/><a href="https://youtu.be/EIzhDG-0Ji8">https://youtu.be/EIzhDG-0Ji8</a><br/></p>
          </li>
          </br>
          <li><p>UltraNest documentation:<br><a href="https://johannesbuchner.github.io/UltraNest/readme.html">https://johannesbuchner.github.io/UltraNest/readme.html</a><br/></p>
          </li>
          </br>
          <li><p>Modified C-statistics (aka W-stat)<br><a href="https://giacomov.github.io/Bias-in-profile-poisson-likelihood/">https://giacomov.github.io/Bias-in-profile-poisson-likelihood/</a><br/></p>
          </li>
          </br>
          <li><p>BXA citation - Buchner et al., (2014; A&A)<br><a href="https://ui.adsabs.harvard.edu/abs/2014A%26A...564A.125B/abstract">https://ui.adsabs.harvard.edu/abs/2014A%26A...564A.125B/abstract</a><br/></p>
          </li>
          </br>
          <li><p>UltraNest citation - Buchner (2021, JOSS)<br><a href="https://arxiv.org/abs/2101.09604">https://arxiv.org/abs/2101.09604</a><br/></p>
          </li>
          </br>
          <li><p>Nested sampling review - Buchner (2021)<br><a href="https://arxiv.org/abs/2101.09675">https://arxiv.org/abs/2101.09675</a><br/></p>
          </li>
          </br>
          <li><p>PCA background - Simmonds et al., (2018, A&A)<br><a href="https://ui.adsabs.harvard.edu/abs/2018A%26A...618A..66S/abstract">https://ui.adsabs.harvard.edu/abs/2018A%26A...618A..66S/abstract</a><br/></p>
          </li>
          </br>
          </ul>
          </ul>
        </div>
</section>

<section id="session1" class="services">
      <div class="container">

        <div class="section-title">
          <ul><h2><i class="bx bx-terminal"></i> Session 1 - spectral fitting & model comparison</h2></ul>
          <ul><p>Key objectives:</p>
          <ul>
          <li>Fit a spectrum with BXA in Sherpa and/or PyXspec</li>
          <li>Use Bayes factors to perform model comparison</li>
          <li>Visualise the confidence ranges on each parameter</li>
          </ul>
          </ul>

          <ul>
          <p>First, <strong>download the following spectral files</strong> from <a href="https://www.dropbox.com/sh/txoilcmnv7p01e6/AABkAvEkCN88mxsqDh_A791Wa?dl=0">here</a>:</p>
          <blockquote>
          <ul>
          <li><p>Source spectrum (binned with <code><a href="https://heasarc.gsfc.nasa.gov/lheasoft/help/ftgrouppha.html">ftgrouppha</a> grouptype=bmin groupscale=1</code>): <code>sim_chan_bmin.pi</code></p></li>
          <li><p>Response: <code>chan.rmf</code></p></li>
          <li><p>Effective area: <code>chan.arf</code></p></li>
          <li><p>Background spectrum: <code>sim_chan_bkg.pi</code></p></li>
          </ul>
          </blockquote>
          <p>PyXspec &amp; Sherpa commands for setting up a spectral fit:</p>
          <ul>
          <li>For using interactive Python:<blockquote><p>PyXspec: <code>$ ipython</code><br/>
          Sherpa: <code>$ sherpa</code></p>
          </blockquote>
          </li>
          <li>For using in scripts:<blockquote><p>PyXspec: <code>$ python3 pyxspec_script.py</code><br/>
          Sherpa: <code>$ sherpa sherpa_script.py</code></p>
          </blockquote>
          </li>
          <li>Setup required packages:<blockquote><p>PyXspec: <code>from xspec import *</code> &amp; <code>import bxa.xspec as bxa</code><br/>
          Sherpa: <code>import bxa.sherpa as bxa</code></p>
          </blockquote>
          </li>
          <li>Set the statistic (here we use modified C-statistics):<blockquote><p>PyXspec: <code>set_statistic("cstat")</code><br/>
          Sherpa: <code>Fit.statistic = "wstat"</code></p>
          </blockquote>
          </li>
          <li>Plot the data in channels or energy:<blockquote><p>PyXspec: <code>Plot.xAxis = "channel"/"keV"</code><br/>
          Sherpa: <code>set_analysis("chan")# or "ener"</code></p>
          </blockquote>
          </li>
          <li>Set the plot device (PyXspec only):<blockquote><p><code>Plot.device = "/null"</code> to not have one (stops plotting window pop-ups)<br/>
          <code>Plot.device = "/xw"</code> (or any other plot device)</p>
          </blockquote>
          </li>
          <li>Load spectra:<blockquote><p>PyXspec: <code>Spectrum("chan_src.pi")</code><br/>
          Sherpa: <code>load_pha(1, "chan_src.pi")</code></p>
          </blockquote>
          </li>
          <li>Ignore channels:<blockquote><p>Pyxspec: <code>s.ignore("0.-0.5 8.-**")</code><br/>
          Sherpa: <code>ignore_id(1, "0.:0.5,8.:")</code></p>
          </blockquote>
          </li>
          <li>Create a model:<blockquote><p>PyXspec: <code>mymod = Model("powerlaw")</code><br/>
          Sherpa: <code>mymod = xspowerlaw.mypow</code> &amp; <code>set_source(mymod)</code></p>
          </blockquote>
          </li>
          <li>Set parameters (note the min, max parameter bounds are used in the BXA priors):<blockquote><p>PyXspec: <code>mymod.powerlaw.phoindex.values = (value, delta, min, bottom, top, max)</code><br/>
          Sherpa: <code>set_par(mypow.phoindex, val=value, min=min, max=max)</code></p>
          </blockquote>
          </li>
          </ul>
          </ul>
          </br>
          
          <ul><h3>Exercise 1.1 - prior predictive checks</h3></ul>
          <ul><p><em>Prior predictive checks are useful to see if the priors chosen can lead to realistic model realisations.</em></p></ul>
          <ul>
          <ul>
          <li>Load the data, notice the correct energies and create a powerlaw model (see the commands listed above for help)</li>
          <li>Set parameter priors in bxa (note the normalisation varies over many orders of magnitude, and the PhoIndex can be assumed to have some value within 1.9 +/- 0.15):<blockquote><p><code>bxa.create_uniform_prior_for(param)</code><br/>
          <code>bxa.create_jeffreys_prior_for(param)</code><br/>
          <code>bxa.create_loguniform_prior_for(param)</code> (equivalent to jeffreys prior above)<br/>
          <code>bxa.create_gaussian_prior_for(param, $\mu$, $\sigma$)</code><br/></p>
          </blockquote>
          </li>
          <li>Create a solver:<blockquote><p><code>solver = bxa.BXASolver(transformations=[priors], outputfiles_basename="powerlaw")</code></p>
          </blockquote>
          </li>
          <li>Perform prior predictive checks:<ol>
          <li>Generate random samples of prior parameter values:<blockquote><p>PyXspec: <code>values = solver.prior_function(numpy.random.uniform(size=solver.paramnames))</code><br/>
          Sherpa: <code>values = solver.prior_transform(numpy.random.uniform(size=solver.paramnames))</code></p>
          </blockquote>
          </li>
          <li>Set the parameters to these values:<blockquote><p>PyXspec: <code>solver.set_parameters(transformations=solver.transformations,values=values)</code><br/>
          Sherpa: <code>for i, p in enumerate(solver.parameters): p.val = values[i]</code></p>
          </blockquote>
          </li>
          <li>Plot the resulting spectra with their models:<blockquote><p>PyXspec: <code>Plot("ld")</code>
          Sherpa: <code>plot_fit(xlog=True, ylog=True)</code></p>
          </blockquote>
          </li>
          </ol>
          </li>
          <li>Are the prior choices reasonable?</li>
          </ul>
          </ul>
          </br>

          <ul><h3>Exercise 1.2 - fit a model to a spectrum</h3></ul>
          <ul>
          <ul>
          <li>First fit the model using Levenberg-Marquadt included in Xspec &amp; Sherpa:<blockquote><p>PyXspec: <code>Fit.perform()</code><br/>
          Sherpa: <code>fit()</code></p>
          </blockquote>
          </li>
          <li>Is the fit good? How can you tell? What does changing the parameters by a small amount do?</li>
          <li>Next perform the fit with BXA:<blockquote><p><code>results = solver.run(resume=True)</code><br/>
          <code>results</code> contains the posterior samples (<code>results["samples"]</code>) for each parameter and the Bayesian evidence for the fit (the quantities should also be printed to the screen after the fit is completed).</p>
          </blockquote>
          </li>
          <li>Examine the best-fit values and uncertainties from the posterior samples. How do the best-fits and confidence ranges compare between BXA and Levenberg-Marquadt?</li>
          </ul>
          </ul>
          
          <ul><h3>Exercise 1.3 - fit and compare multiple models</h3></ul>
          <ul><p><em>Here we use the Bayesian evidence to perform model comparison</em>
          Note to use TBabs, one should set the abundances to those from <a href="https://ui.adsabs.harvard.edu/abs/2000ApJ...542..914W/abstract">Wilms, Allen &amp; McCray (2000)</a>:</p></ul>
          <ul>
          <blockquote><p>PyXspec: <code>Xset.abund = "wilm"</code><br/>
          Sherpa: <code>set_xsabund("wilm")</code></p>
          <ul>
          <li>Fit the following additional 2 models to the data with BXA (don't forget to give unique <code>outputfiles_basename</code> values!):<ol>
          <li>Absorbed powerlaw
          PyXspec: <code>TBabs * powerlaw</code><br/>
          Sherpa: <code>xstbabs * xspowerlaw</code></li>
          <li>Absorbed powerlaw + Gaussian emission line (the emission line is known to have line centroid energy 6.3 +/- 0.15 keV)
          PyXspec: <code>TBabs * powerlaw + gauss</code><br/>
          Sherpa: <code>xstbabs * xspowerlaw + xsgauss</code></li>
          </ol>
          </li>
          <li>Compare the Bayesian Evidence values for each fit:</li>
          <ul><li>Copy the <a href="https://github.com/JohannesBuchner/BXA/blob/master/examples/xspec/model_compare.py">model_compare.py</a> script to your working directory</li></ul>
          <ul><li>Run the script with: <code>$ python model_compare.py outputfiles_basename1/ outputfiles_basename2/ outputfiles_basename3/</code></li></ul>
          <li>Which model best explains the data?</li>
          </ul>
          </blockquote>
          </ul>

          <ul><h3>Exercise 1.4 - visualisation</h3></ul>
          <ul>
          <ul>
          <li>Examine the corner and trace plots that BXA produces (located in <code>outputfiles_basename/plots/</code></li>
          <li>What do these show?</li>
          <li>Are there any parameter degeneracies? Why or why not?</li>
          </ul>
          </ul>
          
          <ul><h3>Exercise 1.5 - fitting multiple datasets simultaneously with BXA</h3></ul>
          <ul><p><em>Sometimes it is advantageous to fit multiple spectra for the same source simultaneously with e.g., a cross-calibration constant to account for instrumental differences in the different spectra.</em></p></ul>
          <ul>
          <ul>
          <li>Download the following NuSTAR/FPMA spectral files from <a href="https://www.dropbox.com/sh/p0wv22yeg7jh1ep/AAA9swZbGF0seQOo2_zFgnjNa?dl=0">here</a>:
          <blockquote>
          <ul>
          <li><p>Source spectrum (binned with <code><a href="https://heasarc.gsfc.nasa.gov/lheasoft/help/ftgrouppha.html">ftgrouppha</a> grouptype=bmin groupscale=1</code>): <code>sim_nuA_bmin.pi</code></p></li>
          <li><p>Response: <code>nuA.rmf</code></p></li>
          <li><p>Effective area: <code>nuA.arf</code></p></li>
          <li><p>Background spectrum: <code>sim_nuA_bkg.pi</code></p></li>
          </ul>
          </blockquote>
          </li>
          <li>NuSTAR has a unique bandpass that extends to E &gt; 10 keV, so is very useful for extending the spectral range one can fit a given model over.</li>
          <li>Include a cross-calibration constant in your model between the Chandra and NuSTAR datasets.</li>
          <li>Fit the new model with BXA and derive a confidence range on the cross-calibration constant.</li>
          <li>How have the confidence ranges on all the parameters changed after including NuSTAR?</li>
          <li>How have the Bayes factors between different model fits changed? Why?</li>
          </ul>
          </ul>

          
          <ul><h3>Exercise 1.6 - (optional, Sherpa only) automated background fitting with BXA</h3></ul>
          <ul>
          <ul>
          <li>Load the data, source model and priors as in exercise 1</li>
          <li><p>Load the automatic PCA background model (see <a href="https://ui.adsabs.harvard.edu/abs/2018A%26A...618A..66S/abstract">Simmonds et al., 2018</a>):</p>
          <blockquote><p><code>from bxa.sherpa.background.pca import auto_background</code><br/>
          <code>set_model(1, model)</code><br/>
          <code>convmodel = get_model(1)</code><br/>
          <code>bkg_model = auto_background(1)</code><br/>
          <code>set_full_model(1, convmodel + bkg_model*get_bkg_scale(1))</code></p>
          </blockquote>
          </li>
          <li><p>Remember to include the zeroth order component from the PCA background model in the priors and parameters list so that BXA knows to vary it as a free parameter:</p>
          <blockquote><p><code>parameters += bkg_model.pars[0]</code><br/>
          <code>priors += [bxa.create_uniform_prior_for(bkg_model.pars[0])]</code></p>
          </blockquote>
          </li>
          <li>Fit the source + background model with BXA</li>
          <li>Is the background fit well?</li>
          <li>Have the uncertainty ranges changed at all for the parameters? Why or why not?</li>
          </ul>
          </ul>
        </div>
</section>

<section id="session2" class="services">
      <div class="container">

        <div class="section-title">
          <ul><h2><i class="bx bx-terminal"></i> Session 2 - more advanced concepts</h2></ul>
          <ul><p>Key objectives:</p>
          <ul>
          <li>Combine individual posteriors to constrain a population</li>
          <li>Calibrate model selection thresholds</li>
          <li>Perform model verification to test the Goodness-of-Fit</li>
          </ul>
          </ul>

          </br>
          <ul><h3>Exercise 2.1 - Bayesian Hierarchical Modelling</h3></ul>
          </br>
          <ul><h3>Exercise 2.2 - calibrating model comparison thresholds</h3></ul>
          </br>
          <ul><h3>Exercise 2.3 - posterior predictive checks</h3></ul>
          </br>
          <ul><h3>Exercise 2.4 - quantile-quantile plots</h3></ul>
        </div>
</section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong><span>iPortfolio</span></strong>
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/ -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- End  Footer -->

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>